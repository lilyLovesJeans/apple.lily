<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/apple.lily/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/apple.lily/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/apple.lily/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/apple.lily/images/logo.svg" color="#222">

<link rel="stylesheet" href="/apple.lily/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lilylovesjeans.github.io","root":"/apple.lily/","images":"/apple.lily/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœå°‹...","empty":"æˆ‘å€‘ç„¡æ³•æ‰¾åˆ°ä»»ä½•æœ‰é—œ ${query} çš„æœç´¢çµæœ","hits_time":"${hits} æ‰¾åˆ° ${time} å€‹çµæœ","hits":"æ‰¾åˆ° ${hits} å€‹çµæœ"}}</script><script src="/apple.lily/js/config.js"></script>

    <meta name="description" content="2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†">
<meta property="og:type" content="article">
<meta property="og:title" content="2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†">
<meta property="og:url" content="https://lilylovesjeans.github.io/apple.lily/2024/08/18/OneDayOneNote/2024-08-22/index.html">
<meta property="og:site_name" content="Apple.Lily å‰ç«¯å­¸ç¿’ç­†è¨˜">
<meta property="og:description" content="2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2024-08-18T11:17:30.000Z">
<meta property="article:modified_time" content="2024-08-18T11:25:47.000Z">
<meta property="article:author" content="Apple.Lily">
<meta property="article:tag" content="OneNote">
<meta property="article:tag" content="XSS">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lilylovesjeans.github.io/apple.lily/2024/08/18/OneDayOneNote/2024-08-22/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-TW","comments":true,"permalink":"https://lilylovesjeans.github.io/apple.lily/2024/08/18/OneDayOneNote/2024-08-22/","path":"2024/08/18/OneDayOneNote/2024-08-22/","title":"2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾† | Apple.Lily å‰ç«¯å­¸ç¿’ç­†è¨˜</title>
  








  <noscript>
    <link rel="stylesheet" href="/apple.lily/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ›å°èˆªæ¬„" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/apple.lily/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Apple.Lily å‰ç«¯å­¸ç¿’ç­†è¨˜</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">è¨˜éŒ„ å‰µä½œ è¨­è¨ˆ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœå°‹" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/apple.lily/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é </a></li><li class="menu-item menu-item-about"><a href="/apple.lily/about/" rel="section"><i class="fa-solid fa-face-smile fa-fw"></i>é—œæ–¼</a></li><li class="menu-item menu-item-tags"><a href="/apple.lily/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ¨™ç±¤</a></li><li class="menu-item menu-item-categories"><a href="/apple.lily/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†é¡</a></li><li class="menu-item menu-item-archives"><a href="/apple.lily/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>æ­¸æª”</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®éŒ„
        </li>
        <li class="sidebar-nav-overview">
          æœ¬ç«™æ¦‚è¦
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Apple.Lily"
      src="https://i.imgur.com/Qxhx2zz.png">
  <p class="site-author-name" itemprop="name">Apple.Lily</p>
  <div class="site-description" itemprop="description">Front End Engineer <br> æ¯æ—¥ä¸€ç­†è¨˜ ä¸æ–·å­¸ç¿’ è¶•ä¸Šé€²åº¦</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/apple.lily/archives/">
          <span class="site-state-item-count">165</span>
          <span class="site-state-item-name">æ–‡ç« </span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/apple.lily/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†é¡</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/apple.lily/tags/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">æ¨™ç±¤</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://lilylovesjeans.github.io/apple.lily/2024/08/18/OneDayOneNote/2024-08-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.imgur.com/Qxhx2zz.png">
      <meta itemprop="name" content="Apple.Lily">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Apple.Lily å‰ç«¯å­¸ç¿’ç­†è¨˜">
      <meta itemprop="description" content="Front End Engineer <br> æ¯æ—¥ä¸€ç­†è¨˜ ä¸æ–·å­¸ç¿’ è¶•ä¸Šé€²åº¦">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾† | Apple.Lily å‰ç«¯å­¸ç¿’ç­†è¨˜">
      <meta itemprop="description" content="2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">ç™¼è¡¨æ–¼</span>
      

      <time title="å‰µå»ºæ™‚é–“ï¼š2024-08-18 19:17:30 / ä¿®æ”¹æ™‚é–“ï¼š19:25:47" itemprop="dateCreated datePublished" datetime="2024-08-18T19:17:30+08:00">2024-08-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†é¡æ–¼</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/apple.lily/categories/OneDayOneNote/" itemprop="url" rel="index"><span itemprop="name">OneDayOneNote</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é–±è®€æ¬¡æ•¸" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é–±è®€æ¬¡æ•¸ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

            <div class="post-description">2024-08-22 XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾† #89<br>Open<br>aszx87410 opened this issue on Nov 13, 2021 Â· 0 comments<br>Open<br>XSS å¾é ­è«‡èµ·ï¼šæ­·å²èˆ‡ç”±ä¾†<br>#89<br>aszx87410 opened this issue on Nov 13, 2021 Â· 0 comments<br>Comments<br>@aszx87410<br>Owner<br>aszx87410 commented on Nov 13, 2021<br>æˆ‘ä»¥å‰æœ‰å¯«éä¸€äº›é—œæ–¼ XSS çš„æ–‡ç« ï¼Œä¸»è¦åœ¨è«‡çš„æ˜¯å¯¦ä½œé¢çš„é˜²ç¯„ä»¥åŠé˜²ç¦¦çš„å„å€‹ç´°ç¯€ï¼š</p>
<p>é˜²æ­¢ XSS å¯èƒ½æ¯”æƒ³åƒä¸­å›°é›£<br>æ·ºè«‡ XSS æ”»æ“Šèˆ‡é˜²ç¦¦çš„å„å€‹ç’°ç¯€<br>é€™ç¯‡åŸæœ¬æƒ³å¯«çš„æ˜¯ XSS çš„åŸºç¤ï¼Œå°±å¤§å®¶éƒ½è½éçš„é‚£ä¸‰ç¨®é¡åˆ¥ï¼šStored(Persistent)ã€Reflected(Non-Persistent) ä»¥åŠ DOM-based XSSï¼Œä½†ç•¶æˆ‘æ­£è¦é–‹å§‹å¯«çš„æ™‚å€™ï¼Œè…¦ä¸­çªç„¶æµ®ç¾äº†å¹¾å€‹å•é¡Œï¼šã€ŒXSS æ˜¯ä»€éº¼æ™‚å€™å‡ºç¾çš„ï¼Ÿé€™ä¸‰ç¨®é¡åˆ¥åˆæ˜¯ä»€éº¼æ™‚å€™é–‹å§‹è¢«åˆ†é¡çš„ï¼Ÿã€</p>
<p>å› æ­¤ï¼Œæˆ‘èŠ±äº†é»æ™‚é–“æ‰¾äº†ä¸€äº›è³‡æ–™ï¼Œé€™ç¯‡æ–‡ç« æœƒè·Ÿå¤§å®¶è«‡è«‡ XSS çš„æ­·å²ï¼Œè®“æˆ‘å€‘ä¸€èµ·æ›´äº†è§£ XSS çš„å‰ä¸–ä»Šç”Ÿã€‚</p>
<p>XSS çš„èª•ç”Ÿ<br>å¾å¾®è»Ÿçš„ MSDN blog åœ¨ 2009 å¹´ 12 æœˆç™¼ä½ˆçš„æ–‡ç« æ¨™é¡Œï¼šHappy 10th birthday Cross-Site Scripting! ä¸­å°±å¯ä»¥çœ‹å‡º XSSï¼ˆCross-Site Scriptingï¼‰é€™å€‹åè©ç´„è«æ˜¯ 1999 å¹´ 12 æœˆèª•ç”Ÿçš„ï¼Œé›¢ç¾åœ¨å·²ç¶“ 20 å¹¾å¹´äº†ã€‚</p>
<p>ï¼ˆä¸‹åœ–ç‚ºä¸Šé¢é€£çµçš„æˆªåœ–ï¼‰</p>
<p>xss-10years</p>
<p>åŸæ–‡æœ€å¾Œæœ‰é€™éº¼ä¸€æ®µè©±ï¼š</p>
<p>Letâ€™s hope that ten years from now weâ€™ll be celebrating the death, not the birth, of Cross-Site Scripting!</p>
<p>å¾ˆéºæ†¾çš„ï¼Œ2009 å¹´çš„ 10 å¹´å¾Œï¼Œä¹Ÿå°±æ˜¯ 2019 å¹´ï¼ŒXSS ä¾èˆŠæŒçºŒæ´»èºè‘—ï¼Œåœ¨ 2017 å¹´çš„ OWASP top 10 æ’åœ¨ç¬¬ä¸ƒåï¼Œ2021 çš„ç‰ˆæœ¬å‰‡ä½µå…¥ç¬¬ä¸‰å Injection çš„é¡åˆ¥ã€‚</p>
<p>è€Œæ–‡ä¸­æåˆ°çš„ï¼šCERTÂ® Advisory CA-2000-02 Malicious HTML Tags Embedded in Client Web Requestsï¼Œå¯ä»¥è®“æˆ‘å€‘ä¸€çªºæœ€æ—©æœŸ XSS çš„é¢è²Œã€‚åº•ä¸‹å°±è®“æˆ‘å€‘ç°¡å–®çœ‹ä¸€ä¸‹é€™å€‹ç¶²é çš„å…§å®¹ï¼š</p>
<p>A web site may inadvertently include malicious HTML tags or script in a dynamically generated page based on unvalidated input from untrustworthy sources. This can be a problem when a web server does not adequately ensure that generated pages are properly encoded to prevent unintended execution of scripts, and when input is not validated to prevent malicious HTML from being presented to the user.</p>
<p>åœ¨ Overview çš„éƒ¨åˆ†å…¶å¯¦å°±æŠŠ XSS çš„æ ¸å¿ƒæ¦‚å¿µè¬›å¾—éå¸¸æ¸…æ¥šäº†ï¼Œserver æ²’æœ‰é©—è­‰è¼¸å…¥æˆ–æ˜¯ç·¨ç¢¼ï¼Œå°è‡´æ”»æ“Šè€…å¯ä»¥æ’å…¥ä¸€äº›æƒ¡æ„çš„ HTML æ¨™ç±¤æˆ–æ˜¯ scriptã€‚</p>
<p>Malicious code provided by one client for another client</p>
<p>Sites that host discussion groups with web interfaces have long guarded against a vulnerability where one client embeds malicious HTML tags in a message intended for another client. For example, an attacker might post a message like Hello message board. This is a message.<SCRIPT>malicious code</SCRIPT>This is the end of my message.</p>
<p>When a victim with scripts enabled in their browser reads this message, the malicious code may be executed unexpectedly. Scripting tags that can be embedded in this way include <SCRIPT> <OBJECT>, <APPLET>, and <EMBED>.</p>
<p>When client-to-client communications are mediated by a server, site developers explicitly recognize that data input is untrustworthy when it is presented to other users. Most discussion group servers either will not accept such input or will encode/filter it before sending anything to other readers.</p>
<p>é€™ä¸€æ®µå‰‡æ˜¯å¾Œä¾†è¢«ç¨±ç‚ºã€ŒStored XSSï¼ˆä¹Ÿç¨±ç‚º Persistent XSSï¼‰ã€çš„åˆ†é¡ï¼Œå‡è¨­æœ‰ä¸€å€‹è¨è«–å€å¯ä»¥è®“äººç•™è¨€ï¼Œä¸€å€‹æƒ¡æ„çš„æ”»æ“Šè€…å¯ä»¥ç•™é€™æ¨£çš„å…§å®¹ï¼š</p>
<p>Hello message board. This is a message.<br><SCRIPT>malicious code</SCRIPT><br>This is the end of my message.<br>ç•¶å…¶ä»–ä½¿ç”¨è€…çœ‹åˆ°é€™ç¯‡ç•™è¨€çš„æ™‚å€™ï¼Œå› ç‚ºç•™è¨€è£¡é¢æœ‰ <script> ï¼Œæ‰€ä»¥å°±æœƒåŸ·è¡Œæ”»æ“Šè€…æ‰€ç•™ä¸‹çš„ JavaScript ç¨‹å¼ç¢¼ã€‚</p>
<p>é™¤äº†é€™å€‹ä»¥å¤–ï¼Œ<object>ã€<applet> è·Ÿ <embed> ä¹Ÿéƒ½å¯ä»¥ç”¨ä¾†åŸ·è¡Œ JavaScriptï¼ˆè©±èªª applet é€™æ¨™ç±¤æ‡‰è©²å·²ç¶“æ²’ç”¨äº†ï¼Œå¯åƒè€ƒï¼šDonâ€™t break the Webï¼šä»¥ SmooshGate ä»¥åŠ keygen ç‚ºä¾‹ ï¼‰ã€‚</p>
<p>Malicious code sent inadvertently by a client for itself</p>
<p>Many Internet web sites overlook the possibility that a client may send malicious data intended to be used only by itself. This is an easy mistake to make. After all, why would a user enter malicious code that only the user will see?</p>
<p>However, this situation may occur when the client relies on an untrustworthy source of information when submitting a request. For example, an attacker may construct a malicious link such as <A HREF="http://example.com/comment.cgi? mycomment=<SCRIPT>malicious code</SCRIPT>"> Click here</A></p>
<p>When an unsuspecting user clicks on this link, the URL sent to example.co includes the malicious code. If the web server sends a page back to the user including the value of mycomment, the malicious code may be executed unexpectedly on the client. This example also applies to untrusted links followed in email or newsgroup messages.</p>
<p>é€™ä¸€æ®µå°±å¾ˆæœ‰è¶£äº†ï¼Œæ¨™é¡Œæ˜¯ï¼šã€ŒMalicious code sent inadvertently by a client for itselfã€ï¼Œç™¼é€çš„å…§å®¹åŸºæœ¬ä¸Šåªæœ‰è‡ªå·±èƒ½çœ‹åˆ°ã€‚</p>
<p>ä¾‹å¦‚èªªç¶²å€ä¸­ mycomment é€™å€‹åƒæ•¸æœƒåæ˜ åˆ°ç•«é¢ä¸Šï¼Œæ‰€ä»¥åƒæ˜¯ <a target="_blank" rel="noopener" href="http://example.com/comment.cgi?mycomment=123%EF%BC%8C%E7%95%AB%E9%9D%A2%E4%B8%8A%E9%9D%A2%E5%B0%B1%E6%9C%83%E5%87%BA%E7%8F%BE">http://example.com/comment.cgi?mycomment=123ï¼Œç•«é¢ä¸Šé¢å°±æœƒå‡ºç¾</a> 123ã€‚</p>
<p>ä½†åªæœ‰è‡ªå·±èƒ½çœ‹åˆ°èƒ½åšä»€éº¼å‘¢ï¼Ÿ</p>
<p>å› ç‚ºæ˜¯é€éç¶²å€ä¸Šçš„ query string ä¾†å‚³éè³‡è¨Šï¼Œå› æ­¤å¯ä»¥ç”¢ç”Ÿé€™æ¨£çš„ä¸€å€‹é€£çµï¼š<a target="_blank" rel="noopener" href="http://example.com/comment.cgi?mycomment=">http://example.com/comment.cgi?mycomment=</a><SCRIPT>malicious code</SCRIPT>ï¼Œæ¥è‘—å†æŠŠé€™å€‹é€£çµå‚³çµ¦å…¶ä»–äººï¼Œç•¶å…¶ä»–äººé»äº†ä»¥å¾Œï¼Œç•«é¢ä¸Šå°±æœƒå‡ºç¾ <SCRIPT>malicious code</SCRIPT>ï¼Œç…§æ¨£é”æˆ XSSã€‚</p>
<p>é€™å°±æ˜¯ XSS çš„å¦å¤–ä¸€ç¨®åˆ†é¡ï¼šReflected XSSï¼Œä½ çš„è¼¸å…¥æœƒåæ˜ åœ¨ç•«é¢ä¸Šã€‚</p>
<p>è€Œé€™å…©ç¨®çš„å·®åˆ¥åœ¨æ–¼ Stored XSS å°±åƒå®ƒçš„åå­—ä¸€æ¨£ï¼ŒXSS payload æ˜¯è¢«ä¿å­˜ä½çš„ï¼Œä»¥è¨è«–å€ä¾†èªªï¼Œæ–‡ç« æ˜¯ä¿å­˜åœ¨è³‡æ–™åº«ä¸­çš„ï¼Œè€Œ Reflected XSS å‰‡ä¸ç„¶ã€‚</p>
<p>ä»¥ PHP ç‚ºä¾‹ï¼ŒReflected XSS çš„ç¨‹å¼ç¢¼å¯èƒ½æœƒåƒé€™æ¨£ï¼š</p>
<?php
   $comment = $_GET['comment'];
?>
<div>
    <?= $comment ?>
</div>
æŠŠ GET çš„åƒæ•¸ç›´æ¥åæ˜ åœ¨ç•«é¢ä¸Šï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡éƒ½å¿…é ˆé€é comment é€™å€‹åƒæ•¸æŠŠ payload å‚³é€²å»ï¼Œå¦å‰‡ä¸æœƒè§¸ç™¼ XSSã€‚

<p>ä»¥ä¸Šé¢æçš„ã€Œè¨è«–å€ã€é€™å€‹ç¶²ç«™ç‚ºä¾‹ï¼ŒStored XSS çš„ç ´å£åŠ›æ‡‰è©²æ˜¯æ›´å¼·å¤§çš„ï¼Œå› ç‚ºåªè¦é»é€²å»ä½ é€™ç¯‡æ–‡ç« å°±æœƒä¸­æ‹›ï¼Œå¯ä»¥æƒ³æˆä½ åœ¨ ptt ç™¼äº†ä¸€ç¯‡æ–‡ç« ï¼Œåªè¦æœ‰é„‰æ°‘é»é€²ä¾†æ–‡ç« å°±æœƒè¢«æ”»æ“Šï¼Œé‚„æ»¿å®¹æ˜“è§¸ç™¼çš„ã€‚</p>
<p>ä½† Reflected XSS å°±ä¸å¤ªä¸€æ¨£äº†ï¼Œé€™éœ€è¦ä½¿ç”¨è€…é»æ“Šé€£çµæ‰æœƒå‡ºäº‹ï¼Œåƒæ˜¯ä½ åœ¨ ptt æ¨æ–‡ç•™äº†ä¸€å€‹é€£çµï¼Œé„‰æ°‘è¦ä¸»å‹•é»é‚£å€‹é€£çµæ‰èƒ½è§¸ç™¼ XSSã€‚</p>
<p>æ–‡ä¸­çš„å…¶ä»–éƒ¨åˆ†ä¹Ÿå¾ˆæœ‰è¶£ï¼Œä¾‹å¦‚èªªä¹Ÿæœ‰æåˆ°åƒ…ç®¡æŠŠ JavaScript disabledï¼Œä¾ç„¶å¯ä»¥ç”¨ HTML èˆ‡ CSS å»ç«„æ”¹ç•«é¢ç­‰ç­‰ï¼Œä¹Ÿæœ‰æåˆ°ä¿®è£œæ–¹å¼ï¼Œåœ¨é€™é‚Šï¼šUnderstanding Malicious Content Mitigation for Web Developers</p>
<p>ä¿®è£œæ–¹å¼é™¤äº†æˆ‘å€‘ç†Ÿæ‚‰çš„é‡å°å…§å®¹ç·¨ç¢¼ä»¥å¤–ï¼Œé‚„æœ‰å¦ä¸€å€‹æ˜¯è¦ã€ŒæŒ‡å®šç·¨ç¢¼æ–¹å¼ã€ï¼Œé€™é‚Šçš„ç·¨ç¢¼æŒ‡çš„æ˜¯ UTF-8 æˆ–æ˜¯ ISO-8859-1 ä»¥åŠ big5 é€™ç¨®ç·¨ç¢¼ã€‚é›–ç„¶èªªç¾åœ¨é€™å€‹å¹´ä»£çµ•å¤§éƒ¨åˆ†ç¶²ç«™éƒ½æ˜¯ UTF-8 äº†ï¼Œä½†æ—©æœŸå…¶å¯¦ä¸ç„¶ã€‚åœ¨ä»¥å¾€ç€è¦½å™¨é‚„æ”¯æ´åƒæ˜¯ UTF-7 é€™æ¨£çš„ç·¨ç¢¼æ–¹å¼ï¼Œå°±ç®—ä¸ç”¨ä¸€äº›ç‰¹æ®Šå­—å…ƒä¹Ÿå¯ä»¥é”æˆ XSSï¼š</p>
<html>
<head><title>test page</title></head>
<body>
  +ADw-script+AD4-alert(1)+ADw-/script+AD4-
</body>
</html>
ç¯„ä¾‹å–è‡ªï¼šXSS å’Œå­—ç¬¦é›†çš„é‚£äº›äº‹å…’ï¼Œè£¡é¢æœ‰æåˆ°æ›´å¤šé€™ç¨®é¡ä¼¼çš„å•é¡Œï¼Œä½†å¤§å¤šæ•¸å•é¡Œæ‡‰è©²éƒ½ç™¼ç”Ÿåœ¨æ¯”è¼ƒæ—©æœŸçš„ç€è¦½å™¨ä¸Šé¢ã€‚

<p>ç¬¬ä¸‰ç¨® XSS åˆ†é¡çš„èª•ç”Ÿ<br>æœ‰çœ‹é XSS æ–‡ç« çš„äººéƒ½çŸ¥é“ï¼Œæœ€å»£ç‚ºäººçŸ¥çš„ XSS åˆ†é¡å¤§æ¦‚å°±ä¸‰ç¨®ï¼š</p>
<p>Stored XSSï¼ˆPersistent XSSï¼‰<br>Reflected XSSï¼ˆNon-Persistent XSSï¼‰<br>DOM-based XSS<br>å†ç¹¼çºŒå¾€ä¸‹ä¹‹å‰ï¼Œæˆ‘å…ˆä¾†å•å•çœ‹å¤§å®¶å…©å€‹å•é¡Œã€‚</p>
<p>ç¬¬ä¸€å€‹å•é¡Œï¼Œå‡è¨­ç¾åœ¨æˆ‘ç™¼äº†ä¸€ç¯‡æ–‡ç« ï¼Œå…§å®¹ç‚º <img src=x onerror=alert(1)>ï¼Œè€Œé¡¯ç¤ºæ–‡ç« çš„é é¢ç¨‹å¼ç¢¼æ˜¯é€™æ¨£çš„ï¼š</p>
<script>
  getPost({ id: 1}).then(post => {
    document.querySelector('.article').innerHTML = post.content
  })
</script>
<p>å› ç‚ºç”¨äº† innerHTML çš„ç·£æ•…ï¼Œæ‰€ä»¥å°±æœ‰äº†ä¸€å€‹ XSS æ¼æ´ï¼Œåœ¨é€™å€‹ç‹€æ³ä¹‹ä¸‹ï¼Œæˆ‘çš„ç•™è¨€ç¢ºå¯¦æœ‰ã€Œä¿å­˜ã€åœ¨è³‡æ–™åº«ï¼Œä½†ä¹ŸåŒæ™‚ç”¨äº† DOM å»æ”¹è®Šå…§å®¹ï¼Œé‚£é€™å€‹ XSS æ‡‰è©²è¢«æ­¸é¡åœ¨ Stored XSSï¼Œé‚„æ˜¯ DOM-based XSSï¼Ÿ</p>
<p>ç¬¬äºŒå€‹å•é¡Œï¼Œå‡è¨­ç¶²é ä¸­æœ‰ä¸€æ®µç¨‹å¼ç¢¼é•·é€™æ¨£ï¼š</p>
<script>
  document.querySelector(".search").innerHTML = decodeURIComponent(location.search)
</script>
<p>é€™é¡¯ç„¶å¯ä»¥é€é query string è£½é€ å‡ºä¸€å€‹ XSS æ¼æ´ï¼Œé€™å€‹ XSS ç¢ºå¯¦åæ˜ äº†ä½¿ç”¨è€…çš„è¼¸å…¥ï¼Œè€Œä¸”æ²’æœ‰è¢«å„²å­˜åœ¨è³‡æ–™åº«è£¡é¢ï¼Œä¸éå»æ˜¯ç”¨ DOM å»æ”¹è®Šå…§å®¹ï¼Œé‚£å®ƒæ‡‰è©²æ˜¯ Reflected XSSï¼Œé‚„æ˜¯ DOM-based XSSï¼Ÿ</p>
<p>åœ¨ç¹¼çºŒå¾€ä¸‹é–±è®€ä¹‹å‰ï¼Œå¤§å®¶å¯ä»¥å…ˆæƒ³ä¸€ä¸‹ä¸Šé¢é€™å…©å€‹å•é¡Œã€‚</p>
<p>å…ˆä¾†è¬›è¬›æˆ‘ä»¥å‰çš„ç­”æ¡ˆï¼Œæˆ‘ä¹‹å‰æ˜¯ç”¨ä¸‹é¢çš„å®šç¾©ä¾†åˆ†é¡é€™å¹¾å€‹çš„ï¼š</p>
<p>æˆ‘çš„ XSS payloadï¼ˆä¾‹å¦‚èªª <script>alert(1)</script>ï¼‰å¦‚æœæœ‰å­˜åœ¨è³‡æ–™åº«ï¼Œé‚£å°±æ˜¯ Stored XSS<br>å¦‚æœä¸æ˜¯ï¼Œé‚£å°±çœ‹æˆ‘çš„ payload æ˜¯ç›´æ¥å¾å¾Œç«¯è¼¸å‡ºï¼Œé‚„æ˜¯é€é DOM å»è³¦å€¼ï¼Œå‰è€…å°±æ˜¯ Reflectedï¼Œå¾Œè€…å°±æ˜¯ DOM-based<br>å¾Œä¾†æˆ‘æ‰ç™¼ç¾é€™å€‹åˆ†é¡æ–¹å¼æ˜¯éŒ¯èª¤çš„ï¼Œå› ç‚ºæˆ‘è¢«ã€Œstoredã€é€™å€‹åè©èª¤å°äº†ï¼Œæ²’æœ‰æ„è­˜åˆ°é€™èƒŒå¾Œçš„æ­·å²èƒŒæ™¯ã€‚</p>
<p>é€™æ˜¯ä»€éº¼æ„æ€å‘¢ï¼Ÿåœ¨ 1999 å¹´ XSS å‰›å‡ºä¾†çš„æ™‚å€™ï¼ŒAjax é‚„ä¸å­˜åœ¨ï¼ˆå®ƒæ˜¯ 2005 å¹´æ‰èª•ç”Ÿçš„ï¼‰ï¼Œæ‰€ä»¥å‰å¾Œç«¯çš„è³‡æ–™äº¤æ›æ‡‰è©²éƒ½æ˜¯é€éè¡¨å–®é€å» Serverï¼Œä¸¦ä¸”ç›´æ¥æŠŠå›æ‡‰ render å‡ºä¾†ã€‚</p>
<p>æ›å¥è©±èªªï¼Œåœ¨ 1999 å¹´çš„æ™‚å€™ï¼ŒåŸºæœ¬ä¸Šæ²’æœ‰ä»€éº¼æ“ä½œæ˜¯ç”¨ JavaScript å»æ›´æ”¹ç•«é¢å…§å®¹çš„ï¼Œå°±ç®—æœ‰ï¼Œä¹Ÿæ˜¯ä¸€äº›æ¯”è¼ƒç„¡é—œç·Šè¦çš„æ“ä½œã€‚ä½†åœ¨ 2021 å¹´éƒ½ä¸ä¸€æ¨£äº†ï¼Œåœ¨é€™å€‹ SPA ç››è¡Œçš„å¹´ä»£ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯é€é JavaScript å»å‘¼å« APIï¼Œæ‹¿åˆ°è³‡æ–™ä»¥å¾Œå†å»æ›´æ”¹ç•«é¢ï¼Œå¾Œç«¯åªè² è²¬æä¾›è³‡æ–™ï¼Œå‰ç«¯é è‘— JavaScript ä¾† renderï¼Œé€™è·Ÿ 20 å¹´å‰å®Œå…¨ä¸åŒã€‚</p>
<p>XSS çš„ä¸‰ç¨®åˆ†é¡ä¹‹ä¸­ï¼Œå‰å…©ç¨® Stored ä»¥åŠ Reflected åœ¨ XSS èª•ç”Ÿä¹‹æ™‚å°±å·²ç¶“å­˜åœ¨äº†ï¼Œè€Œç¬¬ä¸‰ç¨®å‰‡æ™šäº†äº”å¹´æ‰å‡ºç¾ï¼ˆé€™é‚Šçš„ã€Œå‡ºç¾ã€æŒ‡çš„æ˜¯æœ‰å€‹åè©æˆ–åˆ†é¡ä¾†å®šç¾©å®ƒï¼Œè€Œä¸æ˜¯æŒ‡æ”»æ“Šå‡ºç¾ï¼‰ï¼Œå‡ºè™•æ‡‰è©²æ˜¯é€™ä¸€ç¯‡ï¼šDOM Based Cross Site Scripting or XSS of the Third Kind</p>
<p>æ–‡ä¸­çš„ Introduction æœ‰é€™æ¨£ä¸€å€‹æ®µè½ï¼š</p>
<p>XSS is typically categorized into â€œnon-persistentâ€ and â€œpersistentâ€ (â€œreflectedâ€ and â€œstoredâ€ accordingly, as defined in [4]). â€œNon-persistentâ€ means that the malicious (Javascript) payload is echoed by the server in an immediate response to an HTTP request from the victim. â€œPersistentâ€ means that the payload is stored by the system, and may later be embedded by the vulnerable system in an HTML page provided to a victim.</p>
<p>é‡é»æ˜¯ Stored è·Ÿ Reflected é€™å…©å€‹åˆ†é¡éƒ½æœ‰ä¸€å€‹å‰æï¼šã€Œpayload æ˜¯ç”±å¾Œç«¯ç›´æ¥ render çš„ã€ï¼Œè€Œé€™ç¯‡æ–‡ç« æ‰€æåˆ°çš„ç¬¬ä¸‰å€‹åˆ†é¡ DOM-basedï¼ŒæŒ‡çš„å‰‡æ˜¯ã€Œpayload æ˜¯ç”±å‰ç«¯ render å‡ºä¾†çš„ã€ï¼Œé€™å°±æ˜¯ç¬¬ä¸‰ç¨®èˆ‡å‰å…©ç¨®çš„æœ€å¤§å·®ç•°ã€‚</p>
<p>åœ¨åˆ¤åˆ¥ XSS çš„æ™‚å€™ï¼Œæ‡‰è©²å…ˆç¢ºèªçš„å…¶å¯¦æ˜¯ã€Œpayload æ˜¯å‰ç«¯é‚„æ˜¯å¾Œç«¯ renderï¼Ÿã€ï¼Œå¦‚æœæ˜¯å‰ç«¯ render å‡ºä¾†ï¼Œä¸è«–è³‡æ–™å¾å“ªè£¡ä¾†ï¼ˆå¾è³‡æ–™åº«æˆ–æ˜¯ç¶²å€æˆ–ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ï¼‰ï¼Œå°±æ˜¯ DOM-based XSSã€‚å¦‚æœæ˜¯å¾Œç«¯ render å‡ºä¾†ï¼Œæ‰å»å€åˆ†æ˜¯ Stored é‚„æ˜¯ Reflectedã€‚</p>
<p>å› æ­¤ï¼Œå‰›å‰›é‚£å…©å€‹å•é¡Œå› ç‚ºéƒ½æ˜¯å‰ç«¯ render çš„é—œä¿‚ï¼Œéƒ½æœƒè¢«æ­¸é¡åœ¨ DOM-based XSSã€‚</p>
<p>ä¸Šé¢çš„æ–‡ç« ä¸­å°±æœ‰èˆ‰ä¸€å€‹é¡ä¼¼çš„ä¾‹å­ï¼š</p>
<HTML>
<TITLE>Welcome!</TITLE>
Hi
<SCRIPT>
var pos=document.URL.indexOf("name=")+5;
document.write(document.URL.substring(pos,document.URL.length));
</SCRIPT>
<BR>
Welcome to our system
â€¦
</HTML>
åœ¨æ–‡ç« çš„è¨»è§£ä¸­é‚„ç‰¹åˆ¥æåˆ°äº†ï¼š

<p>The malicious payload was not embedded in the raw HTML page at any time (unlike the other flavors of XSS).</p>
<p>å› ç‚º payload å…¶å¯¦ä¸å­˜åœ¨æ–¼ä»»ä½• HTML pageï¼ˆå› ç‚ºæ˜¯å¾Œä¾†æ‰ç”¨ JavaScript æ”¹è®Šçš„ï¼‰ï¼Œæ‰€ä»¥å®ƒä¸å±¬æ–¼ Stored ä¹Ÿä¸å±¬æ–¼ Reflectedï¼Œæ˜¯ç¬¬ä¸‰ç¨®æ–°çš„é¡å‹çš„ XSSã€‚</p>
<p>è‡³æ–¼ä¿®è£œæ–¹å¼çš„è©±ï¼Œç”±æ–¼æ˜¯åœ¨å‰ç«¯ç”¨ JavaScript renderï¼Œæ‰€ä»¥ç·¨ç¢¼çš„å·¥ä½œç•¶ç„¶å°±æ˜¯å‰ç«¯çš„é–‹ç™¼è€…è¦è² è²¬ï¼Œä¸€å€‹å¸¸è¦‹çš„æ–¹å¼æ˜¯é€™æ¨£ï¼ˆç¨‹å¼ç¢¼å–è‡ªï¼šSanitizing user input before adding it to the DOM in Javascriptï¼‰ï¼š</p>
<p>function sanitize(string) {<br>  const map &#x3D; {<br>      â€˜&amp;â€™: â€˜&amp;â€™,<br>      â€˜&lt;â€™: â€˜&lt;â€™,<br>      â€˜&gt;â€™: â€˜&gt;â€™,<br>      â€˜â€œâ€˜: â€˜&quot;â€™,<br>      â€œâ€˜â€œ: â€˜&#x27;â€™,<br>      â€œ&#x2F;â€œ: â€˜&#x2F;â€™,<br>  };<br>  const reg &#x3D; &#x2F;[&amp;&lt;&gt;â€â€˜&#x2F;]&#x2F;ig;<br>  return string.replace(reg, (match)&#x3D;&gt;(map[match]));<br>}<br>ä½†æœ‰ä¸€é»è¦ç‰¹åˆ¥æ³¨æ„ï¼Œé‚£å°±æ˜¯ä¸¦ä¸æ˜¯é€™æ¨£å°±è¬äº‹ğŸ‘ŒğŸ‘Œäº†ï¼ŒXSS çš„é˜²ç¦¦æ¯”è¼ƒéº»ç…©çš„é»æ˜¯è¦é‡å°ä¸åŒæƒ…å¢ƒåšè™•ç†ï¼Œå¦‚åŒ OWASP: Cross Site Scripting Prevention Cheat Sheet ä¸­æœ‰æåˆ°çš„ï¼Œå¦‚æœä½ çš„è¼¸å‡ºæ˜¯è¦æ”¾åˆ° <a href=""> è£¡é¢çš„è©±ï¼Œéœ€è¦è€ƒæ…®åˆ° javascript:alert(1) é€™ç¨®å½¢å¼çš„ payloadï¼Œé€™æ™‚å€™ä¸Šé¢çš„ sanitize function å°±æ²’æœ‰ç”¨äº†ã€‚</p>
<p>çµèª<br>å…¶å¯¦ä¸€é–‹å§‹æœƒç™¼ç¾åˆ†éŒ¯ï¼Œæ˜¯å› ç‚ºåœ¨ HITCON ZeroDay å¹³å°ä¸Šæ‰€å›å ±çš„æ¼æ´åˆ†é¡è¢«æ”¹è®Šï¼Œæ‰è®“æˆ‘æ„è­˜åˆ°è‡ªå·±å°æ–¼é€™å¹¾ç¨®çš„åˆ†æ³•ç†è§£éŒ¯èª¤ï¼Œåœ¨é€™é‚Šä¹Ÿæ„Ÿè¬è² è²¬å¯©æŸ¥çš„å·¥ä½œäººå“¡ã€‚</p>
<p>é™¤äº†é€™å¹¾ç¨®åˆ†æ³•ä»¥å¤–ï¼Œå…¶å¯¦ä¹Ÿæœ‰å…¶ä»–ç¨®çš„åˆ†é¡æ–¹å¼ï¼Œä¾‹å¦‚èªªä½¿ç”¨è€…éœ€è¦è‡ªå·±è¼¸å…¥ XSS payload çš„ Self XSSï¼Œæˆ–è€…æ˜¯åˆ©ç”¨ HTML è§£æä¸ä¸€è‡´è€Œé”æˆçš„ Mutation XSS ç­‰ç­‰ï¼Œå…¶å¯¦éƒ½æ˜¯ XSS å¾ˆæœ‰è¶£çš„æ‡‰ç”¨ï¼Œä»¥å¾Œæœ‰æ©Ÿæœƒå†ä¾†è·Ÿå¤§å®¶åˆ†äº«ã€‚</p>
<p>åŸæ–‡å–è‡ª: https://github.com/aszx87410/blog/issues/89<br>by aszx87410 </p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/apple.lily/tags/OneNote/" rel="tag"># OneNote</a>
              <a href="/apple.lily/tags/XSS/" rel="tag"># XSS</a>
              <a href="/apple.lily/tags/Security/" rel="tag"># Security</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/apple.lily/2024/08/18/OneDayOneNote/2024-08-21/" rel="prev" title="2024-08-21 æ¥è§¸è³‡å®‰æ‰ç™¼ç¾æˆ‘ä¸æ‡‚å‰ç«¯about XSS">
                  <i class="fa fa-angle-left"></i> 2024-08-21 æ¥è§¸è³‡å®‰æ‰ç™¼ç¾æˆ‘ä¸æ‡‚å‰ç«¯about XSS
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/apple.lily/2024/08/18/OneDayOneNote/2024-08-23/" rel="next" title="2024-08-23 ä½¿ç”¨ Cookie å¯¦ç¾ Client ç«¯æ•¸æ“šå­˜å„² â€“ å‰ç«¯å·¥ç¨‹å¸«å¿…å­¸çš„ Web Storage æŠ€è¡“ï¼ˆç¬¬ä¸€ç¯‡ï¼‰">
                  2024-08-23 ä½¿ç”¨ Cookie å¯¦ç¾ Client ç«¯æ•¸æ“šå­˜å„² â€“ å‰ç«¯å·¥ç¨‹å¸«å¿…å­¸çš„ Web Storage æŠ€è¡“ï¼ˆç¬¬ä¸€ç¯‡ï¼‰ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">è‹¥è¦è½‰è¼‰æ–‡ç« ï¼Œéº»ç…©è«‹ä¿ç•™åŸä½œè€…åç¨±èˆ‡åŸå§‹é€£çµã€‚</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="è¨ªå®¢ç¸½æ•¸">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="ç¸½ç€è¦½æ¬¡æ•¸">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="å›åˆ°é ‚ç«¯">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/apple.lily/js/comments.js"></script><script src="/apple.lily/js/utils.js"></script><script src="/apple.lily/js/motion.js"></script><script src="/apple.lily/js/sidebar.js"></script><script src="/apple.lily/js/next-boot.js"></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
