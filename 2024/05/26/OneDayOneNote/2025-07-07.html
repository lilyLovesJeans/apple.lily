<hr>
<h2 id="title-2025-07-07-Line-è¨‚å–®ç³»çµ±-C-éšæ®µï¼ˆLINE-è¨‚å–®æ•´åˆï¼šå‰ç«¯-å¾Œç«¯ä¸²æ¥ï¼‰date-2025-11-12-23-17-22categories-OneDayOneNotetags-OneNote-Lineè¨‚å–®ç³»çµ±-description-2025-07-07-Line-è¨‚å–®ç³»çµ±-C-éšæ®µï¼ˆLINE-è¨‚å–®æ•´åˆï¼šå‰ç«¯-å¾Œç«¯ä¸²æ¥ï¼‰"><a href="#title-2025-07-07-Line-è¨‚å–®ç³»çµ±-C-éšæ®µï¼ˆLINE-è¨‚å–®æ•´åˆï¼šå‰ç«¯-å¾Œç«¯ä¸²æ¥ï¼‰date-2025-11-12-23-17-22categories-OneDayOneNotetags-OneNote-Lineè¨‚å–®ç³»çµ±-description-2025-07-07-Line-è¨‚å–®ç³»çµ±-C-éšæ®µï¼ˆLINE-è¨‚å–®æ•´åˆï¼šå‰ç«¯-å¾Œç«¯ä¸²æ¥ï¼‰" class="headerlink" title="title: 2025-07-07 Line è¨‚å–®ç³»çµ±-C éšæ®µï¼ˆLINE è¨‚å–®æ•´åˆï¼šå‰ç«¯ + å¾Œç«¯ä¸²æ¥ï¼‰date: 2025-11-12 23:17:22categories: OneDayOneNotetags:  [OneNote, Lineè¨‚å–®ç³»çµ±]description:  2025-07-07 Line è¨‚å–®ç³»çµ±-C éšæ®µï¼ˆLINE è¨‚å–®æ•´åˆï¼šå‰ç«¯ + å¾Œç«¯ä¸²æ¥ï¼‰"></a>title: 2025-07-07 Line è¨‚å–®ç³»çµ±-C éšæ®µï¼ˆLINE è¨‚å–®æ•´åˆï¼šå‰ç«¯ + å¾Œç«¯ä¸²æ¥ï¼‰<br>date: 2025-11-12 23:17:22<br>categories: OneDayOneNote<br>tags:  [OneNote, Lineè¨‚å–®ç³»çµ±]<br>description:  2025-07-07 Line è¨‚å–®ç³»çµ±-C éšæ®µï¼ˆLINE è¨‚å–®æ•´åˆï¼šå‰ç«¯ + å¾Œç«¯ä¸²æ¥ï¼‰</h2><h2 id="2025-07-07-Line-è¨‚å–®ç³»çµ±-C-éšæ®µï¼ˆLINE-è¨‚å–®æ•´åˆï¼šå‰ç«¯-å¾Œç«¯ä¸²æ¥ï¼‰"><a href="#2025-07-07-Line-è¨‚å–®ç³»çµ±-C-éšæ®µï¼ˆLINE-è¨‚å–®æ•´åˆï¼šå‰ç«¯-å¾Œç«¯ä¸²æ¥ï¼‰" class="headerlink" title="2025-07-07 Line è¨‚å–®ç³»çµ±-C éšæ®µï¼ˆLINE è¨‚å–®æ•´åˆï¼šå‰ç«¯ + å¾Œç«¯ä¸²æ¥ï¼‰"></a>2025-07-07 Line è¨‚å–®ç³»çµ±-C éšæ®µï¼ˆLINE è¨‚å–®æ•´åˆï¼šå‰ç«¯ + å¾Œç«¯ä¸²æ¥ï¼‰</h2><p>æŠŠ <strong>C éšæ®µï¼ˆLINE è¨‚å–®æ•´åˆï¼šå‰ç«¯ + å¾Œç«¯ä¸²æ¥ï¼‰</strong> çš„è¨­è¨ˆèˆ‡å®Œæ•´å¯¦ä½œæ­¥é©Ÿäº¤çµ¦ä½ ã€‚<br>æˆ‘æœƒå¾ã€Œç”¨æˆ¶åœ¨ LINE ä¸‹å–®çš„ UX æµç¨‹ã€é–‹å§‹ï¼Œæ¥è‘—çµ¦å‡º<strong>è³‡æ–™åº«è®Šæ›´ã€å¾Œç«¯ï¼ˆNode.jsï¼‰å¯¦ä½œã€å‰ç«¯ï¼ˆVue3ï¼‰å¦‚ä½•é¡¯ç¤ºè¨‚å–®ã€LINE webhook è™•ç† postback çš„ç¯„ä¾‹</strong>ï¼Œä¸¦è£œä¸Šæ¸¬è©¦ã€ä¾‹å¤–è™•ç†ã€ä»¥åŠå¯¦å‹™è¦æ³¨æ„çš„å®‰å…¨&#x2F;å¯é æ€§å»ºè­°ã€‚ä½ å¯ä»¥ç›´æ¥è¤‡è£½è²¼ä¸Šç¨‹å¼ç¢¼ä¸¦åŸ·è¡Œã€‚</p>
<hr>
<h1 id="ä¸€ã€ç”¨æˆ¶ä¸‹å–®æµç¨‹ï¼ˆUX-ç°¡è¿°ï¼‰"><a href="#ä¸€ã€ç”¨æˆ¶ä¸‹å–®æµç¨‹ï¼ˆUX-ç°¡è¿°ï¼‰" class="headerlink" title="ä¸€ã€ç”¨æˆ¶ä¸‹å–®æµç¨‹ï¼ˆUX ç°¡è¿°ï¼‰"></a>ä¸€ã€ç”¨æˆ¶ä¸‹å–®æµç¨‹ï¼ˆUX ç°¡è¿°ï¼‰</h1><ol>
<li>ä½¿ç”¨è€…åœ¨ LINE å‚³ã€Œæˆ‘è¦é»é¤ã€æˆ–æŒ‰ä¸»é¸å–® â†’ Bot å›å‚³å•†å“æ¸…å–®ï¼ˆFlex Carouselï¼Œæ¯ä»¶å•†å“å«ã€Œè³¼è²·ã€æŒ‰éˆ•ï¼‰ã€‚</li>
<li>ä½¿ç”¨è€…æŒ‰ã€Œè³¼è²·ã€æŒ‰éˆ•ï¼ˆpostbackï¼‰ï¼ŒæŒ‰éˆ•æœƒé€å‡º <code>action=buy&amp;productId=XXX&amp;qty=1</code>ï¼ˆæˆ– <code>showConfirm</code> å…ˆé¡¯ç¤ºç¢ºèªè¦–çª—ï¼‰ã€‚</li>
<li>Bot æ¥æ”¶åˆ° postback â†’ å¾Œç«¯å»ºç«‹è¨‚å–®ï¼ˆorders + order_itemsï¼‰ â†’ å›è¦†ã€Œè¨‚å–®å·²å»ºç«‹ï¼ˆç·¨è™Ÿï¼šA0001ï¼‰ã€ä¸¦é¡¯ç¤ºè¨‚å–®æ˜ç´°ã€‚</li>
<li>ç®¡ç†å¾Œå°ï¼ˆVueï¼‰å³æ™‚æˆ–çŸ­è¼ªè©¢å–å¾—æ–°è¨‚å–®ï¼Œå¯è®Šæ›´è¨‚å–®ç‹€æ…‹ï¼ˆpending â†’ confirmed â†’ shippedï¼‰ã€‚</li>
<li>ç‹€æ…‹æ›´æ–°æ™‚ï¼Œå¾Œç«¯å¯ç”¨ LINE push&#x2F;message å›è¦†çµ¦è¨‚è³¼ç”¨æˆ¶ï¼ˆæˆ–ç”¨ reply when possibleï¼‰ã€‚</li>
</ol>
<blockquote>
<p>è¨­è¨ˆé‡é»ï¼šç›¡é‡ç”¨ postback èˆ‡ payload åŒ…è³‡æ–™ï¼Œæ¸›å°‘ã€Œé€æ­¥è¼¸å…¥æš«å­˜ç‹€æ…‹ã€çš„è¤‡é›œæ€§ï¼›å¿…è¦æ™‚å¯ç”¨ Redis ä¿å­˜è‡¨æ™‚ç‹€æ…‹ã€‚</p>
</blockquote>
<hr>
<h1 id="äºŒã€è³‡æ–™åº«ï¼ˆMySQLï¼‰è®Šæ›´èˆ‡æ–°å¢è¡¨"><a href="#äºŒã€è³‡æ–™åº«ï¼ˆMySQLï¼‰è®Šæ›´èˆ‡æ–°å¢è¡¨" class="headerlink" title="äºŒã€è³‡æ–™åº«ï¼ˆMySQLï¼‰è®Šæ›´èˆ‡æ–°å¢è¡¨"></a>äºŒã€è³‡æ–™åº«ï¼ˆMySQLï¼‰è®Šæ›´èˆ‡æ–°å¢è¡¨</h1><p>åœ¨ <code>backend/db_init.sql</code>ï¼ˆæˆ–æ–°å¢ migrationï¼‰åŠ å…¥ï¼š</p>
<pre><code class="sql">USE line_order_db;

-- å•†å“ (è‹¥å°šæœªå»ºç«‹)
CREATE TABLE IF NOT EXISTS products (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  price DECIMAL(10,2) NOT NULL,
  description TEXT,
  image_url VARCHAR(255),
  stock INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- è¨‚å–®ä¸»è¡¨
CREATE TABLE IF NOT EXISTS orders (
  id INT AUTO_INCREMENT PRIMARY KEY,
  order_no VARCHAR(30) UNIQUE,
  user_line_id VARCHAR(50),
  customer_name VARCHAR(100),
  phone VARCHAR(50),
  total_price DECIMAL(10,2),
  status ENUM(&#39;pending&#39;,&#39;confirmed&#39;,&#39;cancelled&#39;,&#39;paid&#39;,&#39;shipped&#39;,&#39;completed&#39;) DEFAULT &#39;pending&#39;,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- è¨‚å–®æ˜ç´°
CREATE TABLE IF NOT EXISTS order_items (
  id INT AUTO_INCREMENT PRIMARY KEY,
  order_id INT,
  product_id INT,
  product_name VARCHAR(200),
  qty INT DEFAULT 1,
  unit_price DECIMAL(10,2),
  subtotal DECIMAL(10,2),
  FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE
);

-- è¨‚å–®ç‹€æ…‹æ­·ç¨‹ï¼ˆé¸ç”¨ï¼‰
CREATE TABLE IF NOT EXISTS order_status_history (
  id INT AUTO_INCREMENT PRIMARY KEY,
  order_id INT,
  old_status VARCHAR(50),
  new_status VARCHAR(50),
  changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
</code></pre>
<p><strong>order_no</strong> çš„ç”Ÿæˆç­–ç•¥ï¼š<code>YYYYMMDD-XXXX</code> æˆ– <code>A0001</code> é¡å‹ï¼ˆä¸‹æ–‡æœƒç¤ºç¯„ç°¡å–®ç”Ÿæˆå™¨ï¼‰ã€‚</p>
<hr>
<h1 id="ä¸‰ã€å¾Œç«¯ï¼ˆNode-jsï¼‰å¯¦ä½œé‡é»"><a href="#ä¸‰ã€å¾Œç«¯ï¼ˆNode-jsï¼‰å¯¦ä½œé‡é»" class="headerlink" title="ä¸‰ã€å¾Œç«¯ï¼ˆNode.jsï¼‰å¯¦ä½œé‡é»"></a>ä¸‰ã€å¾Œç«¯ï¼ˆNode.jsï¼‰å¯¦ä½œé‡é»</h1><h2 id="1-æ–°å¢-ä¿®æ”¹å¾Œç«¯è·¯ç”±æª”æ¡ˆ"><a href="#1-æ–°å¢-ä¿®æ”¹å¾Œç«¯è·¯ç”±æª”æ¡ˆ" class="headerlink" title="1) æ–°å¢ &#x2F; ä¿®æ”¹å¾Œç«¯è·¯ç”±æª”æ¡ˆ"></a>1) æ–°å¢ &#x2F; ä¿®æ”¹å¾Œç«¯è·¯ç”±æª”æ¡ˆ</h2><p>åœ¨ <code>backend/routes/</code> åŠ å…©å€‹æª”ï¼š <code>products.js</code>ï¼ˆè‹¥å·²å­˜åœ¨ï¼‰èˆ‡ <code>orders.js</code>ï¼ˆæ›´å®Œå–„ï¼‰ â€” æˆ‘æœƒæŠŠ <code>orders.js</code> çš„é‡é»æµç¨‹ç¤ºç¯„å‡ºä¾†ï¼Œä¸¦åœ¨ <code>line.js</code> ä¸­åŠ ä¸Šè™•ç† <code>postback</code> çš„é‚è¼¯ã€‚</p>
<h3 id="backend-routes-orders-js"><a href="#backend-routes-orders-js" class="headerlink" title="backend/routes/orders.js"></a><code>backend/routes/orders.js</code></h3><pre><code class="js">// backend/routes/orders.js
import express from &quot;express&quot;;
import { pool } from &quot;../db.js&quot;;

const router = express.Router();

// ç”¢ç”Ÿç°¡å–® order_noï¼ˆå»ºè­°å¯æ”¹æˆæ›´ç©©å®šçš„åºè™Ÿæœå‹™ï¼‰
function genOrderNo() {
  const d = new Date();
  const y = d.getFullYear().toString().slice(-2);
  const m = String(d.getMonth()+1).padStart(2,&#39;0&#39;);
  const day = String(d.getDate()).padStart(2,&#39;0&#39;);
  const r = Math.floor(1000 + Math.random() * 9000); // 4-digit random
  return `${y}${m}${day}-${r}`;
}

// å–å¾—æ‰€æœ‰è¨‚å–®ï¼ˆåŒ…å«æ˜ç´°ï¼‰
router.get(&quot;/&quot;, async (req, res) =&gt; {
  try {
    const [orders] = await pool.query(
      `SELECT o.*, (SELECT JSON_ARRAYAGG(JSON_OBJECT(&#39;product_id&#39;, oi.product_id, &#39;product_name&#39;, oi.product_name, &#39;qty&#39;, oi.qty, &#39;unit_price&#39;, oi.unit_price, &#39;subtotal&#39;, oi.subtotal)) FROM order_items oi WHERE oi.order_id = o.id) AS items
       FROM orders o ORDER BY o.id DESC`
    );
    res.json(orders);
  } catch (err) {
    console.error(err);
    res.status(500).json({ error: &quot;Server error&quot; });
  }
});

// å»ºç«‹è¨‚å–®ï¼ˆçµ¦ LINE or å‰ç«¯ å‘¼å«ï¼‰
router.post(&quot;/&quot;, async (req, res) =&gt; {
  const { user_line_id, customer_name, phone, items } = req.body;
  // items = [{product_id, qty}, ...]
  if (!items || !Array.isArray(items) || items.length === 0) {
    return res.status(400).json({ error: &quot;No items&quot; });
  }

  const conn = await pool.getConnection();
  try {
    await conn.beginTransaction();

    // è¨ˆç®—ç¸½åƒ¹ä¸¦æº–å‚™æ˜ç´°
    let total = 0.0;
    const itemRows = [];
    for (const it of items) {
      const [rows] = await conn.query(&quot;SELECT id, name, price FROM products WHERE id = ?&quot;, [it.product_id]);
      if (!rows || rows.length === 0) throw new Error(&quot;Product not found: &quot; + it.product_id);
      const p = rows[0];
      const qty = parseInt(it.qty || 1);
      const subtotal = Number(p.price) * qty;
      total += subtotal;
      itemRows.push({
        product_id: p.id,
        product_name: p.name,
        qty,
        unit_price: p.price,
        subtotal
      });
    }

    const orderNo = genOrderNo();

    const [result] = await conn.query(
      &quot;INSERT INTO orders (order_no, user_line_id, customer_name, phone, total_price) VALUES (?, ?, ?, ?, ?)&quot;,
      [orderNo, user_line_id || null, customer_name || null, phone || null, total]
    );
    const orderId = result.insertId;

    // insert order_items
    for (const ir of itemRows) {
      await conn.query(
        &quot;INSERT INTO order_items (order_id, product_id, product_name, qty, unit_price, subtotal) VALUES (?, ?, ?, ?, ?, ?)&quot;,
        [orderId, ir.product_id, ir.product_name, ir.qty, ir.unit_price, ir.subtotal]
      );
    }

    await conn.commit();

    // å›å‚³è¨‚å–®è³‡æ–™
    res.json({ orderId, orderNo, total, items: itemRows });
  } catch (err) {
    await conn.rollback();
    console.error(&quot;Create order error:&quot;, err);
    res.status(500).json({ error: &quot;Create order failed&quot; });
  } finally {
    conn.release();
  }
});

// æ›´æ–°è¨‚å–®ç‹€æ…‹
router.put(&quot;/:id/status&quot;, async (req, res) =&gt; {
  const id = req.params.id;
  const { status } = req.body;
  const conn = await pool.getConnection();
  try {
    await conn.beginTransaction();
    const [[cur]] = await conn.query(&quot;SELECT status FROM orders WHERE id = ?&quot;, [id]);
    await conn.query(&quot;UPDATE orders SET status = ? WHERE id = ?&quot;, [status, id]);
    await conn.query(&quot;INSERT INTO order_status_history (order_id, old_status, new_status) VALUES (?, ?, ?)&quot;, [id, cur.status, status]);
    await conn.commit();
    res.json({ message: &quot;Status updated&quot; });
  } catch (err) {
    await conn.rollback();
    console.error(err);
    res.status(500).json({ error: &quot;Update failed&quot; });
  } finally {
    conn.release();
  }
});

export default router;
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šé€™æ®µç”¨ transactionï¼ˆäº‹å‹™ï¼‰ä¿è­‰ orders èˆ‡ order_items çš„ä¸€è‡´æ€§ã€‚</p>
</blockquote>
<hr>
<h2 id="2-ä¿®æ”¹-backend-routes-line-jsï¼šè™•ç†-postback-èˆ‡-message-æŒ‡ä»¤"><a href="#2-ä¿®æ”¹-backend-routes-line-jsï¼šè™•ç†-postback-èˆ‡-message-æŒ‡ä»¤" class="headerlink" title="2) ä¿®æ”¹ backend/routes/line.jsï¼šè™•ç† postback èˆ‡ message æŒ‡ä»¤"></a>2) ä¿®æ”¹ <code>backend/routes/line.js</code>ï¼šè™•ç† postback èˆ‡ message æŒ‡ä»¤</h2><pre><code class="js">// backend/routes/line.js ï¼ˆé‡é»æ®µï¼‰
import express from &quot;express&quot;;
import { middleware, Client } from &quot;@line/bot-sdk&quot;;
import dotenv from &quot;dotenv&quot;;
import { pool } from &quot;../db.js&quot;;
dotenv.config();

const router = express.Router();
const config = {
  channelAccessToken: process.env.LINE_CHANNEL_ACCESS_TOKEN,
  channelSecret: process.env.LINE_CHANNEL_SECRET,
};
const client = new Client(config);
router.post(&#39;/webhook&#39;, middleware(config), async (req, res) =&gt; {
  try {
    const events = req.body.events || [];
    for (const event of events) {
      // æ–‡å­—è¨Šæ¯ï¼šå•Ÿå‹•é¸å–®
      if (event.type === &#39;message&#39; &amp;&amp; event.message.type === &#39;text&#39;) {
        const text = event.message.text.trim();
        if (text === &#39;æˆ‘è¦é»é¤&#39; || text === &#39;é»é¤&#39;) {
          // è®€å–å•†å“ä¸¦é€ Flex carousel
          const [products] = await pool.query(&#39;SELECT id, name, price, description, image_url FROM products WHERE stock &gt; 0 LIMIT 10&#39;);
          const bubbles = products.map(p =&gt; ({
            type: &#39;bubble&#39;,
            hero: p.image_url ? { type: &#39;image&#39;, url: p.image_url, size: &#39;full&#39;, aspectRatio: &#39;20:13&#39;, aspectMode: &#39;cover&#39; } : undefined,
            body: {
              type: &#39;box&#39;,
              layout: &#39;vertical&#39;,
              contents: [
                { type: &#39;text&#39;, text: p.name, weight: &#39;bold&#39;, size: &#39;lg&#39;, wrap: true },
                { type: &#39;text&#39;, text: `åƒ¹æ ¼ï¼š$${p.price}`, size: &#39;sm&#39;, wrap: true, margin: &#39;md&#39; },
                { type: &#39;text&#39;, text: p.description || &#39;&#39;, size: &#39;sm&#39;, wrap: true, margin: &#39;md&#39; }
              ]
            },
            footer: {
              type: &#39;box&#39;,
              layout: &#39;vertical&#39;,
              spacing: &#39;sm&#39;,
              contents: [
                { type: &#39;button&#39;, style: &#39;primary&#39;, action: { type: &#39;postback&#39;, label: &#39;è³¼è²·&#39;, data: `action=buy&amp;productId=${p.id}&amp;qty=1` } }
              ]
            }
          }));
          const flex = { type: &#39;carousel&#39;, contents: bubbles.length ? bubbles : [{ type: &#39;bubble&#39;, body: { type: &#39;box&#39;, layout: &#39;vertical&#39;, contents: [{ type: &#39;text&#39;, text: &#39;ç›®å‰ç„¡å•†å“&#39; }] } }] };
          await client.replyMessage(event.replyToken, { type: &#39;flex&#39;, altText: &#39;å•†å“åˆ—è¡¨&#39;, contents: flex });
          continue;
        }
        // å…¶ä»–æ–‡å­—é è¨­å›è¦†
        await client.replyMessage(event.replyToken, { type: &#39;text&#39;, text: &#39;è¼¸å…¥ã€Œæˆ‘è¦é»é¤ã€é–‹å§‹é»é¤æµç¨‹&#39; });
      }

      // postback eventï¼ˆæŒ‰è³¼è²·ï¼‰
      else if (event.type === &#39;postback&#39;) {
        // postback.data æœƒæ˜¯ URL style query string
        const qs = new URLSearchParams(event.postback.data);
        const action = qs.get(&#39;action&#39;);
        if (action === &#39;buy&#39;) {
          const productId = parseInt(qs.get(&#39;productId&#39;));
          const qty = parseInt(qs.get(&#39;qty&#39;) || &#39;1&#39;);
          const userId = event.source.userId;

          // å¾ DB å–å¾—ç”¢å“è³‡è¨Š
          const [[prod]] = await pool.query(&#39;SELECT id, name, price FROM products WHERE id = ?&#39;, [productId]);
          if (!prod) {
            await client.replyMessage(event.replyToken, { type: &#39;text&#39;, text: &#39;æ‰¾ä¸åˆ°è©²å•†å“ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚&#39; });
            continue;
          }

          // å»ºç«‹è¨‚å–®ï¼ˆç°¡å–®ç‰ˆï¼Œcustomer info ç‚º nullï¼‰
          const conn = await pool.getConnection();
          try {
            await conn.beginTransaction();
            const subtotal = Number(prod.price) * qty;
            const orderNo = `L${Date.now().toString().slice(-6)}`;
            const [r] = await conn.query(&#39;INSERT INTO orders (order_no, user_line_id, total_price) VALUES (?, ?, ?)&#39;, [orderNo, userId, subtotal]);
            const orderId = r.insertId;
            await conn.query(&#39;INSERT INTO order_items (order_id, product_id, product_name, qty, unit_price, subtotal) VALUES (?, ?, ?, ?, ?, ?)&#39;, [orderId, prod.id, prod.name, qty, prod.price, subtotal]);
            await conn.commit();

            // å›è¦†ä½¿ç”¨è€… order info
            const text = `å·²å»ºç«‹è¨‚å–®\nç·¨è™Ÿï¼š${orderNo}\nå•†å“ï¼š${prod.name}\næ•¸é‡ï¼š${qty}\nç¸½åƒ¹ï¼š$${subtotal}\næˆ‘å€‘å°‡ç›¡å¿«è¯çµ¡æ‚¨ã€‚`;
            await client.replyMessage(event.replyToken, { type: &#39;text&#39;, text });

            // å¯é¸ï¼šé€šçŸ¥ç®¡ç†è€…ï¼ˆè‹¥ä½ åœ¨ .env æ”¾ ADMIN_LINE_IDï¼‰
            const adminId = process.env.ADMIN_LINE_ID;
            if (adminId) {
              await client.pushMessage(adminId, { type: &#39;text&#39;, text: `æ–°è¨‚å–®ï¼š${orderNo}ï¼Œè²·å®¶:${userId}ï¼Œå•†å“:${prod.name} x${qty}` });
            }
          } catch (err) {
            await conn.rollback();
            console.error(err);
            await client.replyMessage(event.replyToken, { type: &#39;text&#39;, text: &#39;å»ºç«‹è¨‚å–®å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚&#39; });
          } finally {
            conn.release();
          }
        }
      }
    } // end for events

    res.status(200).send(&#39;OK&#39;);
  } catch (err) {
    console.error(&#39;Webhook error&#39;, err);
    res.status(500).end();
  }
});

export default router;
</code></pre>
<blockquote>
<p>é‡é»ï¼š<code>postback.data</code> å¸¸ç”¨ URLQuery æ ¼å¼ä¾†å‚³é <code>action</code> &#x2F; <code>productId</code> &#x2F; <code>qty</code>ï¼Œæ¥åˆ°å°±åšäº‹ã€‚</p>
</blockquote>
<hr>
<h1 id="å››ã€å‰ç«¯ï¼ˆç®¡ç†å¾Œå°ï¼‰æ”¹é€ ï¼šé¡¯ç¤ºè¨‚å–®è©³æƒ…èˆ‡ç‹€æ…‹é€šçŸ¥"><a href="#å››ã€å‰ç«¯ï¼ˆç®¡ç†å¾Œå°ï¼‰æ”¹é€ ï¼šé¡¯ç¤ºè¨‚å–®è©³æƒ…èˆ‡ç‹€æ…‹é€šçŸ¥" class="headerlink" title="å››ã€å‰ç«¯ï¼ˆç®¡ç†å¾Œå°ï¼‰æ”¹é€ ï¼šé¡¯ç¤ºè¨‚å–®è©³æƒ…èˆ‡ç‹€æ…‹é€šçŸ¥"></a>å››ã€å‰ç«¯ï¼ˆç®¡ç†å¾Œå°ï¼‰æ”¹é€ ï¼šé¡¯ç¤ºè¨‚å–®è©³æƒ…èˆ‡ç‹€æ…‹é€šçŸ¥</h1><p>å‰é¢ B éšæ®µå·²æœ‰ <code>Orders.vue</code>ã€‚è£œå¼·è¦é»ï¼š</p>
<ul>
<li>é¡¯ç¤º <code>items</code>ï¼ˆå¾ orders API ä¸­å–å¾— JSON Arrayï¼‰</li>
<li>æ–°å¢ã€Œé€šçŸ¥è²·å®¶ã€æŒ‰éˆ•ï¼ˆcall backend route æ›´æ–°ç‹€æ…‹ä¸¦æ¨é€ LINE messageï¼‰</li>
<li>è‹¥æƒ³å³æ™‚å‘ˆç¾æ–°è¨‚å–®ï¼šå¯æ¡çŸ­è¼ªè©¢ï¼ˆæ¯ 5â€“10 ç§’è«‹æ±‚ <code>/orders</code>ï¼‰æˆ– WebSocketï¼ˆé€²éšï¼‰ã€‚</li>
</ul>
<p>ç°¡å–®çš„ <code>Orders.vue</code> æ“´å……ç¯„ä¾‹ï¼ˆåªé¡¯ç¤º itemsï¼‰ï¼š</p>
<pre><code class="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;è¨‚å–®ç®¡ç†&lt;/h2&gt;
    &lt;table&gt;
      &lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;ç·¨è™Ÿ&lt;/th&gt;&lt;th&gt;ç¸½åƒ¹&lt;/th&gt;&lt;th&gt;ç‹€æ…‹&lt;/th&gt;&lt;th&gt;æ˜ç´°&lt;/th&gt;&lt;th&gt;æ“ä½œ&lt;/th&gt;&lt;/tr&gt;
      &lt;tr v-for=&quot;o in orders&quot; :key=&quot;o.id&quot;&gt;
        &lt;td&gt;{{ o.id }}&lt;/td&gt;
        &lt;td&gt;{{ o.order_no }}&lt;/td&gt;
        &lt;td&gt;{{ o.total_price }}&lt;/td&gt;
        &lt;td&gt;{{ o.status }}&lt;/td&gt;
        &lt;td&gt;
          &lt;ul&gt;
            &lt;li v-for=&quot;it in JSON.parse(o.items || &#39;[]&#39;)&quot; :key=&quot;it.product_id&quot;&gt;
              {{ it.product_name }} x{{ it.qty }} (${ { it.unit_price } }) å°è¨ˆ:{{ it.subtotal }}
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;/td&gt;
        &lt;td&gt;
          &lt;button @click=&quot;updateStatus(o.id,&#39;confirmed&#39;)&quot;&gt;ç¢ºèª&lt;/button&gt;
          &lt;button @click=&quot;notifyUser(o.id)&quot;&gt;é€šçŸ¥ç”¨æˆ¶&lt;/button&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted } from &#39;vue&#39;;
import axios from &#39;axios&#39;;
const api = &quot;http://localhost:3000/orders&quot;;
const orders = ref([]);
async function load() { const res = await axios.get(api); orders.value = res.data; }
async function updateStatus(id, status) { await axios.put(`${api}/${id}/status`, { status }); await load(); }
async function notifyUser(id) { await axios.post(`http://localhost:3000/orders/${id}/notify`); alert(&#39;å·²é€šçŸ¥&#39;); }
onMounted(() =&gt; { load(); setInterval(load, 10000); });
&lt;/script&gt;
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š<code>o.items</code> åœ¨ <code>orders</code> route æˆ‘ç”¨ JSON_ARRAYAGG å›å‚³ç‚º JSON å­—ä¸²ï¼›å‰ç«¯é ˆ parseã€‚</p>
</blockquote>
<hr>
<h1 id="äº”ã€å¾Œç«¯ï¼šå¢åŠ é€šçŸ¥-APIï¼ˆç®¡ç†è€…æŒ‰éˆ•å‘¼å«ï¼‰"><a href="#äº”ã€å¾Œç«¯ï¼šå¢åŠ é€šçŸ¥-APIï¼ˆç®¡ç†è€…æŒ‰éˆ•å‘¼å«ï¼‰" class="headerlink" title="äº”ã€å¾Œç«¯ï¼šå¢åŠ é€šçŸ¥ APIï¼ˆç®¡ç†è€…æŒ‰éˆ•å‘¼å«ï¼‰"></a>äº”ã€å¾Œç«¯ï¼šå¢åŠ é€šçŸ¥ APIï¼ˆç®¡ç†è€…æŒ‰éˆ•å‘¼å«ï¼‰</h1><p>åœ¨ <code>orders.js</code> å¢åŠ é€šçŸ¥ routeï¼š</p>
<pre><code class="js">// notify endpoint
router.post(&quot;/:id/notify&quot;, async (req, res) =&gt; {
  const id = req.params.id;
  try {
    const [[order]] = await pool.query(&quot;SELECT * FROM orders WHERE id = ?&quot;, [id]);
    if (!order) return res.status(404).json({ error: &quot;not found&quot; });
    // å–å¾—è²·å®¶ user_line_id èˆ‡è¨‚å–®æ˜ç´°
    const [items] = await pool.query(&quot;SELECT * FROM order_items WHERE order_id = ?&quot;, [id]);

    // æº–å‚™è¨Šæ¯
    const text = `æ‚¨çš„è¨‚å–® ${order.order_no} å·²æ›´æ–°ã€‚ç‹€æ…‹ï¼š${order.status}ã€‚`;
    // ä½¿ç”¨ client.pushMessageï¼ˆéœ€åœ¨ route å–å¾— client æˆ–åœ¨æ›´é«˜å±¤æ³¨å…¥ï¼‰
    // é€™è£¡å‡è¨­ä½ æŠŠ LINE client export æˆ–åœ¨æ­¤æª” require
    import { Client } from &#39;@line/bot-sdk&#39;; // éœ€æ”¾åœ¨æª”æ¡ˆé ‚ç«¯
    const client = new Client({ channelAccessToken: process.env.LINE_CHANNEL_ACCESS_TOKEN });
    if (order.user_line_id) {
      await client.pushMessage(order.user_line_id, { type: &#39;text&#39;, text });
    }

    res.json({ message: &#39;Notified&#39; });
  } catch (err) {
    console.error(err);
    res.status(500).json({ error: &quot;Notify fail&quot; });
  }
});
</code></pre>
<p>ï¼ˆå¯¦éš›è«‹æŠŠ <code>Client</code> å»ºåœ¨å…±ç”¨æª”æˆ– <code>index.js</code>ï¼Œä¸è¦æ¯æ¬¡æ–°å»ºï¼‰</p>
<hr>
<h1 id="å…­ã€æ¸¬è©¦æ–¹æ³•ï¼ˆé€æ­¥ï¼‰"><a href="#å…­ã€æ¸¬è©¦æ–¹æ³•ï¼ˆé€æ­¥ï¼‰" class="headerlink" title="å…­ã€æ¸¬è©¦æ–¹æ³•ï¼ˆé€æ­¥ï¼‰"></a>å…­ã€æ¸¬è©¦æ–¹æ³•ï¼ˆé€æ­¥ï¼‰</h1><ol>
<li>å•Ÿå‹• MySQLã€å¾Œç«¯ï¼ˆ<code>npm run dev</code>ï¼‰ã€ngrokï¼ˆ<code>ngrok http 3000</code>ï¼‰ä¸¦æŠŠ webhook è¨­å¥½ã€‚</li>
<li>åœ¨å¾Œå° <code>Products</code> æ–°å¢ä¸€å…©å€‹æ¸¬è©¦å•†å“ï¼ˆæˆ–ç›´æ¥åœ¨ MySQL insertï¼‰ã€‚</li>
<li>ç”¨æ‰‹æ©Ÿåœ¨ LINE ç™¼ã€Œæˆ‘è¦é»é¤ã€ â†’ æ‡‰æ”¶åˆ° Flex å•†å“æ¸…å–®ï¼ˆå«ã€Œè³¼è²·ã€ï¼‰ã€‚</li>
<li>æŒ‰ã€Œè³¼è²·ã€â†’ Bot å›è¦†ã€Œå·²å»ºç«‹è¨‚å–®ã€èˆ‡è¨‚å–®ç·¨è™Ÿã€‚</li>
<li>å¾Œå° <code>/orders</code> æ‡‰ç«‹å³å¯è¦‹è©²è¨‚å–®ï¼ˆæˆ–çŸ­è¼ªè©¢å¾Œå‡ºç¾ï¼‰ã€‚</li>
<li>åœ¨å¾Œå°å°‡ç‹€æ…‹æ”¹ç‚º <code>confirmed</code> â†’ é»ã€Œé€šçŸ¥ç”¨æˆ¶ã€â†’ æª¢æŸ¥ LINE ä½¿ç”¨è€…æ˜¯å¦æ”¶åˆ°æ¨æ’­ã€‚</li>
</ol>
<p><strong>æ¨¡æ“¬ postback æ¸¬è©¦ï¼ˆcurlï¼‰</strong>ï¼š<br>ä½ å¯ä»¥ç”¨ curl æ¨¡æ“¬ LINE çš„ postback eventï¼ˆé–‹ç™¼æ™‚ï¼‰ï¼š</p>
<pre><code class="bash">curl -X POST http://localhost:3000/line/webhook \
 -H &quot;Content-Type: application/json&quot; \
 -d &#39;{&quot;events&quot;:[{&quot;type&quot;:&quot;postback&quot;,&quot;replyToken&quot;:&quot;000&quot;,&quot;source&quot;:{&quot;userId&quot;:&quot;U111&quot;},&quot;postback&quot;:{&quot;data&quot;:&quot;action=buy&amp;productId=1&amp;qty=1&quot;}}]}&#39;
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š<code>@line/bot-sdk</code> middleware æœƒé©—è­‰ç°½ç« ï¼ŒçœŸå¯¦ LINE äº‹ä»¶æœƒæœ‰ signatureã€‚ç‚ºæœ¬åœ°æ¸¬è©¦å¯è‡¨æ™‚ç”¨ route ä¸å¸¶ middlewareï¼ˆåƒ…æ¸¬åŠŸèƒ½ï¼‰ï¼Œæˆ–ç”¨å·¥å…·ç¹éã€‚</p>
</blockquote>
<hr>
<h1 id="ä¸ƒã€å¯é æ€§ã€å®‰å…¨èˆ‡å¯¦å‹™æ³¨æ„äº‹é …"><a href="#ä¸ƒã€å¯é æ€§ã€å®‰å…¨èˆ‡å¯¦å‹™æ³¨æ„äº‹é …" class="headerlink" title="ä¸ƒã€å¯é æ€§ã€å®‰å…¨èˆ‡å¯¦å‹™æ³¨æ„äº‹é …"></a>ä¸ƒã€å¯é æ€§ã€å®‰å…¨èˆ‡å¯¦å‹™æ³¨æ„äº‹é …</h1><ul>
<li><strong>Webhook é©—ç°½</strong>ï¼šåœ¨é–‹ç™¼ï¼ˆå…¬é–‹æ¸¬è©¦ï¼‰æ™‚ä½¿ç”¨ <code>middleware(config)</code>ï¼›éƒ¨ç½²æ™‚çµ•å°ä¸è¦é—œæ‰é©—ç°½ã€‚</li>
<li><strong>äº‹å‹™è™•ç†</strong>ï¼šå»ºç«‹è¨‚å–®æ™‚ä½¿ç”¨ DB transactionï¼ˆç¯„ä¾‹å·²ç¤ºï¼‰ã€‚</li>
<li><strong>é‡è¤‡è«‹æ±‚</strong>ï¼špostback æˆ– webhook å¯èƒ½é‡é€ã€‚å»ºè­°åœ¨ <code>orders</code> è¡¨ç”¨ <code>order_no</code> æˆ–æä¾› <code>client_request_id</code> ä¾†åšå»é‡æª¢æŸ¥ï¼ˆidempotency keyï¼‰ã€‚</li>
<li><strong>è³‡æ–™é©—è­‰</strong>ï¼šåœ¨å¾Œç«¯å° <code>items</code>ã€<code>product_id</code>ã€<code>qty</code> åšå‹åˆ¥èˆ‡ç¯„åœæª¢æŸ¥ã€‚</li>
<li><strong>è³‡å®‰</strong>ï¼š<code>LINE_CHANNEL_ACCESS_TOKEN</code> &#x2F; <code>LINE_CHANNEL_SECRET</code> &#x2F; DB å¯†ç¢¼ æ”¾ <code>.env</code>ï¼Œä¸ç®¡æ¸¬è©¦æˆ–ä¸Šç·šéƒ½ä¸è¦æäº¤åˆ° Gitã€‚</li>
<li><strong>éŒ¯èª¤å›è£œ</strong>ï¼šå¦‚æœ DB å¯«å…¥æˆåŠŸä½†å›è¦†å¤±æ•—ï¼Œé ˆæœ‰ logging èˆ‡é‡è©¦æ©Ÿåˆ¶ï¼ˆæ’ç¨‹æˆ– queueï¼‰ã€‚</li>
<li><strong>ç•°åœ°é€šçŸ¥</strong>ï¼šè‹¥æƒ³æŠŠé€šçŸ¥çµ¦ç®¡ç†è€…æˆ–å¤šå€‹ adminï¼Œå¯æŠŠ admin list å­˜åˆ° DB æˆ– env ä¸­ä¸¦è¿´åœˆ pushã€‚</li>
<li><strong>æ•ˆèƒ½</strong>ï¼šé«˜é »æŸ¥è©¢è¨‚å–®ç‹€æ…‹æ™‚å¯å°‡ç†±é–€æ¬„ä½å¿«å–åˆ° Redisï¼ˆä¾‹å¦‚ order status, last 50 ordersï¼‰ã€‚</li>
<li><strong>ä½¿ç”¨è€…è³‡æ–™</strong>ï¼šå»ºè­°æŠŠ LINE user profileï¼ˆdisplayNameã€pictureï¼‰å­˜æ–¼ <code>users</code> è¡¨ï¼Œç¬¬ä¸€æ¬¡äº’å‹•ç”¨ <code>client.getProfile(userId)</code> å–å¾—ä¸¦å„²å­˜ã€‚</li>
</ul>
<hr>
<h1 id="å…«ã€æ“´å……å»ºè­°ï¼ˆä¸‹ä¸€æ­¥å¯ä»¥åšï¼‰"><a href="#å…«ã€æ“´å……å»ºè­°ï¼ˆä¸‹ä¸€æ­¥å¯ä»¥åšï¼‰" class="headerlink" title="å…«ã€æ“´å……å»ºè­°ï¼ˆä¸‹ä¸€æ­¥å¯ä»¥åšï¼‰"></a>å…«ã€æ“´å……å»ºè­°ï¼ˆä¸‹ä¸€æ­¥å¯ä»¥åšï¼‰</h1><ul>
<li><strong>ä»˜æ¬¾æ•´åˆï¼ˆLINE Pay &#x2F;ç¬¬ä¸‰æ–¹ï¼‰</strong>ï¼šå»ºç«‹ <code>payments</code> è¡¨ä¸¦æŠŠä»˜æ¬¾ç‹€æ…‹èˆ‡è¨‚å–®é—œè¯ã€‚</li>
<li><strong>å¤šå•†å“ä¸€æ¬¡ä¸‹å–®</strong>ï¼šç›®å‰ç¤ºä¾‹æ˜¯å–®ä¸€ product buyï¼Œå¯æ“´å±•ç‚ºè³¼ç‰©è»Šï¼ˆmultiple itemsï¼‰æµç¨‹ (è¦è¨­è¨ˆã€Œé¸æ“‡æ•¸é‡ã€ã€ŒåŠ å…¥è³¼ç‰©è»Šã€ã€Œçµå¸³ç•«é¢ã€)ã€‚</li>
<li><strong>ç‹€æ…‹ WebSocket å³æ™‚æ¨é€ç®¡ç†å¾Œå°</strong>ï¼šç”¨ Socket.io æŠŠæ–°è¨‚å–®å³æ™‚æ¨çµ¦ç®¡ç†è€…é é¢ã€‚</li>
<li><strong>è‡ªç„¶èªè¨€è§£æ</strong>ï¼šç”¨ç°¡å–®é—œéµå­—æˆ– webhook å‚³åˆ° NLPï¼ˆä¾‹å¦‚ Rasaï¼‰è§£æè¤‡é›œå¥å­ï¼ˆã€Œæˆ‘è¦å…©å€‹ç´…è±†éºµåŒ…æ˜å¤© 10 é»å–è²¨ã€ï¼‰ï¼Œå†è½‰æˆçµæ§‹åŒ– order payloadã€‚</li>
<li><strong>æ¸¬è©¦è‡ªå‹•åŒ–</strong>ï¼šç”¨ Postman collection + Newman æˆ– Jest + Supertest åš webhook èˆ‡ API è‡ªå‹•æ¸¬è©¦ã€‚</li>
</ul>
<hr>
<h1 id="ä¹ã€Checkpointï¼ˆC-éšæ®µå®Œæˆåˆ¤å®šï¼‰"><a href="#ä¹ã€Checkpointï¼ˆC-éšæ®µå®Œæˆåˆ¤å®šï¼‰" class="headerlink" title="ä¹ã€Checkpointï¼ˆC éšæ®µå®Œæˆåˆ¤å®šï¼‰"></a>ä¹ã€Checkpointï¼ˆC éšæ®µå®Œæˆåˆ¤å®šï¼‰</h1><ul>
<li><input disabled="" type="checkbox"> LINE <code>æˆ‘è¦é»é¤</code> èƒ½å›å‚³å•†å“ Flex carouselã€‚</li>
<li><input disabled="" type="checkbox"> ä½¿ç”¨è€…æŒ‰ã€Œè³¼è²·ã€å¾Œï¼Œå¾Œç«¯åœ¨ <code>orders</code>ã€<code>order_items</code> ç”Ÿæˆæ­£ç¢ºè³‡æ–™ã€‚</li>
<li><input disabled="" type="checkbox"> å¾Œå° Orders é èƒ½çœ‹åˆ°æ–°è¨‚å–®èˆ‡æ˜ç´°ï¼ˆitemsï¼‰ã€‚</li>
<li><input disabled="" type="checkbox"> ç®¡ç†å¾Œå°å¯æ”¹ç‹€æ…‹ä¸¦é€šçŸ¥ä½¿ç”¨è€…ï¼ˆLINE pushï¼‰ã€‚</li>
<li><input disabled="" type="checkbox"> æœ‰éŒ¯èª¤è™•ç†èˆ‡ DB äº‹å‹™ä¿è­‰ï¼Œä¸æœƒé€ æˆåŠæˆå“è¨‚å–®ã€‚</li>
</ul>
<hr>
<h2 id="ğŸ“˜-éšæ®µ-C-ä¸»è¦ä»»å‹™ï¼ˆä½ ç›®å‰æ‰€åœ¨çš„ä½ç½®ï¼‰"><a href="#ğŸ“˜-éšæ®µ-C-ä¸»è¦ä»»å‹™ï¼ˆä½ ç›®å‰æ‰€åœ¨çš„ä½ç½®ï¼‰" class="headerlink" title="ğŸ“˜ éšæ®µ C ä¸»è¦ä»»å‹™ï¼ˆä½ ç›®å‰æ‰€åœ¨çš„ä½ç½®ï¼‰"></a>ğŸ“˜ éšæ®µ C ä¸»è¦ä»»å‹™ï¼ˆä½ ç›®å‰æ‰€åœ¨çš„ä½ç½®ï¼‰</h2><p>é€™å€‹éšæ®µçš„é‡é»æ˜¯ï¼š</p>
<blockquote>
<p>è®“ LINE Bot èƒ½å’Œä½ çš„å¾Œç«¯ã€å‰ç«¯çœŸæ­£ã€Œä¸²èµ·ä¾†ã€ï¼Œè‡ªå‹•è™•ç†è¨‚å–®ã€‚</p>
</blockquote>
<h3 id="âœ…-å·²æº–å‚™å®Œæˆçš„å…§å®¹"><a href="#âœ…-å·²æº–å‚™å®Œæˆçš„å…§å®¹" class="headerlink" title="âœ… å·²æº–å‚™å®Œæˆçš„å…§å®¹"></a>âœ… å·²æº–å‚™å®Œæˆçš„å…§å®¹</h3><ul>
<li><code>.env</code> ç¯„ä¾‹ âœ…</li>
<li><code>db_init.sql</code> âœ…</li>
<li>å°ˆæ¡ˆè³‡æ–™å¤¾çµæ§‹ï¼ˆbackend + frontendï¼‰âœ…</li>
</ul>
<hr>
<h2 id="ğŸ§©-ä¸‹ä¸€æ­¥å¯¦ä½œå»ºè­°ï¼ˆC-éšæ®µè¦åšçš„-4-å¤§æ­¥ï¼‰"><a href="#ğŸ§©-ä¸‹ä¸€æ­¥å¯¦ä½œå»ºè­°ï¼ˆC-éšæ®µè¦åšçš„-4-å¤§æ­¥ï¼‰" class="headerlink" title="ğŸ§© ä¸‹ä¸€æ­¥å¯¦ä½œå»ºè­°ï¼ˆC éšæ®µè¦åšçš„ 4 å¤§æ­¥ï¼‰"></a>ğŸ§© ä¸‹ä¸€æ­¥å¯¦ä½œå»ºè­°ï¼ˆC éšæ®µè¦åšçš„ 4 å¤§æ­¥ï¼‰</h2><table>
<thead>
<tr>
<th>æ­¥é©Ÿ</th>
<th>åç¨±</th>
<th>ä»»å‹™å…§å®¹</th>
<th>ç›®çš„</th>
</tr>
</thead>
<tbody><tr>
<td><strong>C1</strong></td>
<td>è¨­å®š LINE Webhook</td>
<td>LINE Developers å»ºç«‹ Messaging APIã€è¨­ webhook URLã€è¨­å®š channel token&#x2F;secret</td>
<td>è®“ LINE å‚³è¨Šæ¯èƒ½é€åˆ°ä½ çš„ Node.js ä¼ºæœå™¨</td>
</tr>
<tr>
<td><strong>C2</strong></td>
<td>Node.js webhook è™•ç†</td>
<td>å»ºç«‹ <code>/webhook</code> è·¯ç”±ï¼Œé©—è­‰ LINE ç°½ç« ï¼Œæ¥æ”¶è¨Šæ¯äº‹ä»¶</td>
<td>èƒ½è™•ç†ä½¿ç”¨è€…çš„ LINE è¨Šæ¯ï¼ˆä¾‹å¦‚ã€ŒæŸ¥è©¢å•†å“ã€ï¼‰</td>
</tr>
<tr>
<td><strong>C3</strong></td>
<td>è¨‚å–®æ•´åˆé‚è¼¯</td>
<td>ä½¿ç”¨è€…è¼¸å…¥å•†å“ä»£è™Ÿ â†’ Node.js æŸ¥è©¢ MySQL â†’ å›å‚³è¨‚å–®è³‡è¨Š</td>
<td>è®“ Bot å¯ä»¥çœŸå¯¦å›è¦†å•†å“è³‡æ–™</td>
</tr>
<tr>
<td><strong>C4</strong></td>
<td>Vue3 å¾Œå°æ•´åˆé¡¯ç¤º</td>
<td>æ–°å¢ã€ŒLINE è¨‚å–®ç´€éŒ„ã€é é¢ï¼Œé¡¯ç¤º MySQL è¨‚å–®ç‹€æ…‹</td>
<td>è®“ç®¡ç†è€…åœ¨å‰ç«¯å¾Œå°çœ‹åˆ°ä¾†è‡ª LINE çš„è¨‚å–®ç´€éŒ„</td>
</tr>
</tbody></table>
<hr>
<hr>
<p>å¦‚æœä½ é¡˜æ„ï¼Œæˆ‘å¯ä»¥<strong>ç«‹åˆ»å¹«ä½ ç”¢å‡º</strong>ï¼š</p>
<ol>
<li>å·²ä¿®æ”¹å¥½çš„ <code>backend/routes/orders.js</code> èˆ‡ <code>backend/routes/line.js</code> å®Œæ•´æª”æ¡ˆï¼ˆå¯ç›´æ¥æ”¾å…¥ä½  repoï¼‰ã€‚</li>
<li>ä¸€å€‹ç°¡æ˜“çš„ <code>Products</code> seed SQLï¼ˆå¹¾ç­†å•†å“ï¼‰èˆ‡ <code>Orders</code> æ¸¬è©¦è…³æœ¬ï¼ˆcurl ç¯„ä¾‹ï¼‰ã€‚</li>
<li>å‰ç«¯ <code>Orders.vue</code> çš„å®Œæ•´å¯ç›´æ¥æ›¿æ›ç‰ˆæœ¬ï¼ŒåŒ…å« notify æŒ‰éˆ•å°æ‡‰çš„ API å‘¼å«ã€‚</li>
</ol>
<p>ä½ è¦æˆ‘å…ˆæŠŠå“ªä¸€ä»½æª”æ¡ˆå…§å®¹ç›´æ¥è²¼çµ¦ä½ ï¼ˆæˆ–æ‰“åŒ…æˆå¯ä»¥ <code>git clone</code> çš„ commit ç¯„ä¾‹ï¼‰ï¼Ÿ</p>
