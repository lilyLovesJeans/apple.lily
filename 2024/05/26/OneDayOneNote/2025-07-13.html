<hr>
<h2 id="title-2025-07-13-Line-è¨‚å–®ç³»çµ±-C-éšæ®µ-C4-å­éšæ®µ-â€”-LINE-è¨‚å–®ç´€éŒ„å¾Œç«¯-API-å»ºç«‹date-2025-11-13-23-19-37categories-OneDayOneNotetags-OneNote-Lineè¨‚å–®ç³»çµ±-description-2025-07-13-Line-è¨‚å–®ç³»çµ±-C-éšæ®µ-C4-å­éšæ®µ-â€”-LINE-è¨‚å–®ç´€éŒ„å¾Œç«¯-API-å»ºç«‹"><a href="#title-2025-07-13-Line-è¨‚å–®ç³»çµ±-C-éšæ®µ-C4-å­éšæ®µ-â€”-LINE-è¨‚å–®ç´€éŒ„å¾Œç«¯-API-å»ºç«‹date-2025-11-13-23-19-37categories-OneDayOneNotetags-OneNote-Lineè¨‚å–®ç³»çµ±-description-2025-07-13-Line-è¨‚å–®ç³»çµ±-C-éšæ®µ-C4-å­éšæ®µ-â€”-LINE-è¨‚å–®ç´€éŒ„å¾Œç«¯-API-å»ºç«‹" class="headerlink" title="title: 2025-07-13 Line è¨‚å–®ç³»çµ±-C éšæ®µ C4 å­éšæ®µ â€” LINE è¨‚å–®ç´€éŒ„å¾Œç«¯ API å»ºç«‹date: 2025-11-13 23:19:37categories: OneDayOneNotetags:  [OneNote, Lineè¨‚å–®ç³»çµ±]description: 2025-07-13 Line è¨‚å–®ç³»çµ±-C éšæ®µ C4 å­éšæ®µ â€” LINE è¨‚å–®ç´€éŒ„å¾Œç«¯ API å»ºç«‹"></a>title: 2025-07-13 Line è¨‚å–®ç³»çµ±-C éšæ®µ C4 å­éšæ®µ â€” LINE è¨‚å–®ç´€éŒ„å¾Œç«¯ API å»ºç«‹<br>date: 2025-11-13 23:19:37<br>categories: OneDayOneNote<br>tags:  [OneNote, Lineè¨‚å–®ç³»çµ±]<br>description: 2025-07-13 Line è¨‚å–®ç³»çµ±-C éšæ®µ C4 å­éšæ®µ â€” LINE è¨‚å–®ç´€éŒ„å¾Œç«¯ API å»ºç«‹</h2><h2 id="2025-07-13-Line-è¨‚å–®ç³»çµ±-C-éšæ®µ-C4-å­éšæ®µ-â€”-LINE-è¨‚å–®ç´€éŒ„å¾Œç«¯-API-å»ºç«‹"><a href="#2025-07-13-Line-è¨‚å–®ç³»çµ±-C-éšæ®µ-C4-å­éšæ®µ-â€”-LINE-è¨‚å–®ç´€éŒ„å¾Œç«¯-API-å»ºç«‹" class="headerlink" title="2025-07-13 Line è¨‚å–®ç³»çµ±-C éšæ®µ C4 å­éšæ®µ â€” LINE è¨‚å–®ç´€éŒ„å¾Œç«¯ API å»ºç«‹"></a>2025-07-13 Line è¨‚å–®ç³»çµ±-C éšæ®µ C4 å­éšæ®µ â€” LINE è¨‚å–®ç´€éŒ„å¾Œç«¯ API å»ºç«‹</h2><p>æˆ‘å€‘ç¾åœ¨é€²å…¥ <strong>ğŸ“˜ C4 å­éšæ®µ â€” LINE è¨‚å–®ç´€éŒ„å¾Œç«¯ API å»ºç«‹</strong>ï¼Œ<br>é€™æ˜¯æ•´å€‹ C éšæ®µçš„æœ€å¾Œä¸€å€‹éƒ¨åˆ†ï¼Œ<br>å®Œæˆå¾Œä½ å°±èƒ½åœ¨ <strong>Vue3 å¾Œå° (<code>LineOrders.vue</code>)</strong> çœ‹åˆ°çœŸå¯¦çš„ LINE è¨‚å–®è³‡æ–™ã€‚</p>
<hr>
<h2 id="ğŸ§©-æ–°å¢æª”æ¡ˆï¼šbackend-routes-orders-js"><a href="#ğŸ§©-æ–°å¢æª”æ¡ˆï¼šbackend-routes-orders-js" class="headerlink" title="ğŸ§© æ–°å¢æª”æ¡ˆï¼šbackend/routes/orders.js"></a>ğŸ§© æ–°å¢æª”æ¡ˆï¼š<code>backend/routes/orders.js</code></h2><p>é€™å€‹ API å°‡æœƒï¼š</p>
<ul>
<li>æä¾› <code>/api/orders</code> è·¯ç”±ï¼ŒæŸ¥è©¢æ‰€æœ‰è¨‚å–®è³‡æ–™ï¼›</li>
<li>è®“å‰ç«¯ï¼ˆ<code>LineOrders.vue</code>ï¼‰å¯ä»¥å–å¾—ä¸¦é¡¯ç¤ºï¼›</li>
<li>æ”¯æ´ã€Œæ–°å¢è¨‚å–®ã€åŠŸèƒ½ï¼ˆå¯ç”± LINE webhook å‘¼å«ï¼‰ã€‚</li>
</ul>
<hr>
<h3 id="âœ…-ç¯„ä¾‹ç¨‹å¼"><a href="#âœ…-ç¯„ä¾‹ç¨‹å¼" class="headerlink" title="âœ… ç¯„ä¾‹ç¨‹å¼"></a>âœ… ç¯„ä¾‹ç¨‹å¼</h3><pre><code class="js">// backend/routes/orders.js
import express from &quot;express&quot;;
import mysql from &quot;mysql2/promise&quot;;

const router = express.Router();

// å»ºç«‹ MySQL é€£ç·šæ± 
const pool = mysql.createPool({
  host: process.env.DB_HOST,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
  database: process.env.DB_NAME,
});

// âœ… å–å¾—æ‰€æœ‰è¨‚å–®
router.get(&quot;/orders&quot;, async (req, res) =&gt; {
  try {
    const [rows] = await pool.query(
      `SELECT o.id, o.user_name, p.name AS product_name, o.quantity, o.status, o.created_at
       FROM orders o
       LEFT JOIN products p ON o.product_id = p.id
       ORDER BY o.created_at DESC`
    );
    res.json(rows);
  } catch (err) {
    console.error(&quot;å–å¾—è¨‚å–®éŒ¯èª¤:&quot;, err);
    res.status(500).json({ error: &quot;ä¼ºæœå™¨éŒ¯èª¤&quot; });
  }
});

// âœ… æ–°å¢è¨‚å–®ï¼ˆå¯ç”± LINE Webhook å‘¼å«ï¼‰
router.post(&quot;/orders&quot;, async (req, res) =&gt; {
  const { user_name, product_id, quantity } = req.body;
  try {
    const [result] = await pool.query(
      `INSERT INTO orders (user_name, product_id, quantity, status, created_at)
       VALUES (?, ?, ?, &#39;æ–°è¨‚å–®&#39;, NOW())`,
      [user_name, product_id, quantity]
    );
    res.json({ success: true, orderId: result.insertId });
  } catch (err) {
    console.error(&quot;æ–°å¢è¨‚å–®éŒ¯èª¤:&quot;, err);
    res.status(500).json({ error: &quot;ä¼ºæœå™¨éŒ¯èª¤&quot; });
  }
});

export default router;
</code></pre>
<hr>
<h2 id="ğŸ§±-åœ¨-server-js-ä¸­æ•´åˆ"><a href="#ğŸ§±-åœ¨-server-js-ä¸­æ•´åˆ" class="headerlink" title="ğŸ§± åœ¨ server.js ä¸­æ•´åˆ"></a>ğŸ§± åœ¨ <code>server.js</code> ä¸­æ•´åˆ</h2><p>è«‹ç¢ºèªä½ åœ¨ <code>backend/server.js</code> ä¸­æœ‰é€™æ®µè¨­å®šï¼š</p>
<pre><code class="js">import express from &quot;express&quot;;
import cors from &quot;cors&quot;;
import dotenv from &quot;dotenv&quot;;
import lineWebhook from &quot;./routes/lineWebhook.js&quot;;
import ordersRoute from &quot;./routes/orders.js&quot;;

dotenv.config();

const app = express();
app.use(cors());
app.use(express.json());

app.use(&quot;/api&quot;, lineWebhook);
app.use(&quot;/api&quot;, ordersRoute);

app.get(&quot;/&quot;, (req, res) =&gt; {
  res.send(&quot;LINE è¨‚å–®ç³»çµ±å¾Œç«¯é‹è¡Œä¸­ ğŸš€&quot;);
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () =&gt; console.log(`âœ… Server é‹è¡Œæ–¼ http://localhost:${PORT}`));
</code></pre>
<hr>
<h2 id="ğŸ—‚ï¸-è³‡æ–™åº«çµæ§‹ç¢ºèª"><a href="#ğŸ—‚ï¸-è³‡æ–™åº«çµæ§‹ç¢ºèª" class="headerlink" title="ğŸ—‚ï¸ è³‡æ–™åº«çµæ§‹ç¢ºèª"></a>ğŸ—‚ï¸ è³‡æ–™åº«çµæ§‹ç¢ºèª</h2><p>ç¢ºä¿ä½ çš„ <code>db_init.sql</code> è‡³å°‘åŒ…å«ä»¥ä¸‹ä¸‰å€‹è¡¨æ ¼ï¼š</p>
<pre><code class="sql">CREATE TABLE products (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100),
  description TEXT,
  price DECIMAL(10,2)
);

CREATE TABLE orders (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_name VARCHAR(100),
  product_id INT,
  quantity INT DEFAULT 1,
  status VARCHAR(50) DEFAULT &#39;æ–°è¨‚å–®&#39;,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (product_id) REFERENCES products(id)
);
</code></pre>
<hr>
<h2 id="ğŸ”„-æ•´é«”æµç¨‹ç¤ºæ„"><a href="#ğŸ”„-æ•´é«”æµç¨‹ç¤ºæ„" class="headerlink" title="ğŸ”„ æ•´é«”æµç¨‹ç¤ºæ„"></a>ğŸ”„ æ•´é«”æµç¨‹ç¤ºæ„</h2><table>
<thead>
<tr>
<th>éšæ®µ</th>
<th>å‹•ä½œ</th>
<th>ç³»çµ±åæ‡‰</th>
</tr>
</thead>
<tbody><tr>
<td>1ï¸âƒ£</td>
<td>ä½¿ç”¨è€…åœ¨ LINE è¼¸å…¥ï¼šã€Œå•†å“ 1ã€</td>
<td>Bot å›å‚³å•†å“è³‡è¨Š</td>
</tr>
<tr>
<td>2ï¸âƒ£</td>
<td>ä½¿ç”¨è€…è¼¸å…¥ï¼šã€Œè³¼è²· 1ã€</td>
<td>webhook è§¸ç™¼ <code>/api/orders</code> â†’ æ–°å¢è¨‚å–®</td>
</tr>
<tr>
<td>3ï¸âƒ£</td>
<td>å¾Œç«¯å¯«å…¥ MySQL â†’ <code>orders</code> è¡¨</td>
<td>å„²å­˜è¨‚å–®ç´€éŒ„</td>
</tr>
<tr>
<td>4ï¸âƒ£</td>
<td>Vue3 å¾Œå° <code>LineOrders.vue</code> å‘¼å« <code>/api/orders</code></td>
<td>é¡¯ç¤ºè¨‚å–®æ¸…å–®ï¼ˆè‡ªå‹•æ›´æ–°ï¼‰</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸš€-æœ¬éšæ®µå®Œæˆå¾Œä½ å°‡æ“æœ‰"><a href="#ğŸš€-æœ¬éšæ®µå®Œæˆå¾Œä½ å°‡æ“æœ‰" class="headerlink" title="ğŸš€ æœ¬éšæ®µå®Œæˆå¾Œä½ å°‡æ“æœ‰"></a>ğŸš€ æœ¬éšæ®µå®Œæˆå¾Œä½ å°‡æ“æœ‰</h2><p>âœ… LINE è¨Šæ¯äº‹ä»¶æ¥æ”¶èˆ‡å›è¦†ï¼ˆwebhookï¼‰<br>âœ… è‡ªå‹•æ–°å¢è¨‚å–®ç´€éŒ„è‡³ MySQL<br>âœ… å¾Œå° Vue3 é é¢å¯æŸ¥è©¢è¨‚å–®<br>âœ… Node.js API çµæ§‹æ¸…æ™°ï¼Œæ–¹ä¾¿æ“´å……</p>
<hr>
<p>æ˜¯å¦è¦æˆ‘å¹«ä½ ç¹¼çºŒï¼š<br>ğŸ‘‰ æ•´åˆ webhook èˆ‡ <code>/orders</code> APIï¼Œè®“ã€Œä½¿ç”¨è€…è¼¸å…¥ã€è³¼è²· 1ã€æ™‚è‡ªå‹•å»ºç«‹è¨‚å–®ã€ï¼Ÿ<br>ï¼ˆé€™æœƒè®“æ•´å€‹ LINE â†” å¾Œç«¯ â†” è³‡æ–™åº« â†” Vue å‰ç«¯æµç¨‹å®Œå…¨æ‰“é€šï¼‰</p>
