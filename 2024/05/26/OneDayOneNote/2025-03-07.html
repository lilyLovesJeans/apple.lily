<hr>
<h2 id="title-20250307-天氣查詢應用程式」的第-3-步：自由選擇三個城市date-2025-09-06-23-01-39tags-Javascript-Vue-description-20250307-天氣查詢應用程式」的第-3-步：自由選擇三個城市"><a href="#title-20250307-天氣查詢應用程式」的第-3-步：自由選擇三個城市date-2025-09-06-23-01-39tags-Javascript-Vue-description-20250307-天氣查詢應用程式」的第-3-步：自由選擇三個城市" class="headerlink" title="title: 20250307-天氣查詢應用程式」的第 3 步：自由選擇三個城市date: 2025-09-06 23:01:39tags:  [Javascript,Vue]description: 20250307-天氣查詢應用程式」的第 3 步：自由選擇三個城市"></a>title: 20250307-天氣查詢應用程式」的第 3 步：自由選擇三個城市<br>date: 2025-09-06 23:01:39<br>tags:  [Javascript,Vue]<br>description: 20250307-天氣查詢應用程式」的第 3 步：自由選擇三個城市</h2><h1 id="20250307-天氣查詢應用程式」的第-3-步：自由選擇三個城市"><a href="#20250307-天氣查詢應用程式」的第-3-步：自由選擇三個城市" class="headerlink" title="20250307-天氣查詢應用程式」的第 3 步：自由選擇三個城市"></a>20250307-天氣查詢應用程式」的第 3 步：自由選擇三個城市</h1><p>你現在的程式其實<strong>已經能顯示三個城市的天氣</strong>了（臺北市、臺中市、高雄市），因為你用這行篩選了資料：</p>
<pre><code class="js">const allCities = [&#39;臺北市&#39;, &#39;臺中市&#39;, &#39;高雄市&#39;]
</code></pre>
<hr>
<h3 id="✅-下一步目標（你說的「可以一次選三個城市」）："><a href="#✅-下一步目標（你說的「可以一次選三個城市」）：" class="headerlink" title="✅ 下一步目標（你說的「可以一次選三個城市」）："></a>✅ 下一步目標（你說的「可以一次選三個城市」）：</h3><p>你想讓使用者「<strong>自由選擇三個城市</strong>」，而不是程式寫死三個城市名稱。</p>
<hr>
<h2 id="✅-修改目標："><a href="#✅-修改目標：" class="headerlink" title="✅ 修改目標："></a>✅ 修改目標：</h2><p>讓使用者從城市下拉選單中選擇三個城市，並顯示它們的天氣資訊。</p>
<hr>
<h2 id="✅-第一步：新增一個多選下拉選單"><a href="#✅-第一步：新增一個多選下拉選單" class="headerlink" title="✅ 第一步：新增一個多選下拉選單"></a>✅ 第一步：新增一個多選下拉選單</h2><pre><code class="html">&lt;select multiple v-model=&quot;selectedCities&quot;&gt;
  &lt;option v-for=&quot;city in allCityNames&quot; :key=&quot;city&quot;&gt;{{ city }}&lt;/option&gt;
&lt;/select&gt;
</code></pre>
<hr>
<h2 id="✅-完整程式碼（支援自由選三城市）"><a href="#✅-完整程式碼（支援自由選三城市）" class="headerlink" title="✅ 完整程式碼（支援自由選三城市）"></a>✅ 完整程式碼（支援自由選三城市）</h2><pre><code class="vue">&lt;template&gt;
  &lt;h2&gt;🌦️ 自選三個城市天氣概況&lt;/h2&gt;

  &lt;!-- 多選城市 --&gt;
  &lt;label&gt;選擇最多三個城市：&lt;/label&gt;
  &lt;select multiple v-model=&quot;selectedCities&quot;&gt;
    &lt;option v-for=&quot;city in allCityNames&quot; :key=&quot;city&quot;&gt;{{ city }}&lt;/option&gt;
  &lt;/select&gt;
  &lt;p&gt;目前選擇：{{ selectedCities.join(&#39;, &#39;) }}&lt;/p&gt;

  &lt;div class=&quot;weather-container&quot;&gt;
    &lt;div v-for=&quot;city in filteredWeatherData&quot; :key=&quot;city.locationName&quot; class=&quot;city-card&quot;&gt;
      &lt;h3&gt;🌆 {{ city.locationName }}&lt;/h3&gt;
      &lt;p&gt;☀️ 天氣：{{ getWeatherElement(city, &#39;Wx&#39;) }}&lt;/p&gt;
      &lt;p&gt;🔥 最高溫：{{ getWeatherElement(city, &#39;MaxT&#39;) }}°C&lt;/p&gt;
      &lt;p&gt;❄️ 最低溫：{{ getWeatherElement(city, &#39;MinT&#39;) }}°C&lt;/p&gt;
      &lt;p&gt;🌧️ 降雨機率：{{ getWeatherElement(city, &#39;PoP&#39;) }}%&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, computed, onMounted } from &#39;vue&#39;

const apiKey = &#39;你的 CWA API Key&#39; // 請替換成你的 key
const url = `https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=${apiKey}`

const weatherData = ref([])
const allCityNames = ref([])
const selectedCities = ref([])

onMounted(async () =&gt; {
  try {
    const response = await fetch(url)
    const data = await response.json()
    const locations = data.records.location

    weatherData.value = locations
    allCityNames.value = locations.map(loc =&gt; loc.locationName)

    // 預設三個城市
    selectedCities.value = [&#39;臺北市&#39;, &#39;臺中市&#39;, &#39;高雄市&#39;]
  } catch (error) {
    console.error(&#39;❌ 發生錯誤:&#39;, error)
  }
})

const filteredWeatherData = computed(() =&gt;
  weatherData.value.filter(city =&gt; selectedCities.value.includes(city.locationName))
)

function getWeatherElement(city, elementName) {
  const element = city.weatherElement.find(el =&gt; el.elementName === elementName)
  return element?.time[0]?.parameter?.parameterName || &#39;N/A&#39;
}
&lt;/script&gt;

&lt;style scoped&gt;
select {
  width: 100%;
  padding: 0.5rem;
  margin-bottom: 1rem;
  font-size: 1rem;
}

.weather-container {
  display: flex;
  flex-wrap: wrap;
  gap: 1.5rem;
}

.city-card {
  flex: 1 1 300px;
  max-width: 300px;
  background: #f0f8ff;
  padding: 1rem;
  border-radius: 0.75rem;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  border-left: 6px solid #3498db;
}
&lt;/style&gt;
</code></pre>
<hr>
<h2 id="✅-Bonus-小提醒：限制最多選三個城市（進階）"><a href="#✅-Bonus-小提醒：限制最多選三個城市（進階）" class="headerlink" title="✅ Bonus 小提醒：限制最多選三個城市（進階）"></a>✅ Bonus 小提醒：限制最多選三個城市（進階）</h2><p>你可以加入檢查邏輯，限制使用者最多只能選三個城市，有需要我可以幫你加上這段邏輯。</p>
<hr>
<p>需要我幫你加「限制只能選三個城市」或「根據天氣變化變色背景」嗎？👀</p>
<p>好的！以下是加上「<strong>最多只能選三個城市</strong>」的版本 ✅<br>當使用者選超過三個時，會自動移除最後選的那個，並顯示警告。</p>
<hr>
<h2 id="✅-完整程式碼：限制選最多三個城市"><a href="#✅-完整程式碼：限制選最多三個城市" class="headerlink" title="✅ 完整程式碼：限制選最多三個城市"></a>✅ 完整程式碼：限制選最多三個城市</h2><pre><code class="vue">&lt;template&gt;
  &lt;h2&gt;🌦️ 自選三個城市天氣概況&lt;/h2&gt;

  &lt;!-- 多選城市 --&gt;
  &lt;label&gt;請選擇最多三個城市：&lt;/label&gt;
  &lt;select multiple v-model=&quot;selectedCities&quot; @change=&quot;checkLimit&quot;&gt;
    &lt;option v-for=&quot;city in allCityNames&quot; :key=&quot;city&quot;&gt;{{ city }}&lt;/option&gt;
  &lt;/select&gt;
  &lt;p&gt;目前選擇：{{ selectedCities.join(&#39;, &#39;) }}&lt;/p&gt;
  &lt;p v-if=&quot;limitReached&quot; style=&quot;color: red;&quot;&gt;⚠️ 最多只能選三個城市&lt;/p&gt;

  &lt;div class=&quot;weather-container&quot;&gt;
    &lt;div v-for=&quot;city in filteredWeatherData&quot; :key=&quot;city.locationName&quot; class=&quot;city-card&quot;&gt;
      &lt;h3&gt;🌆 {{ city.locationName }}&lt;/h3&gt;
      &lt;p&gt;☀️ 天氣：{{ getWeatherElement(city, &#39;Wx&#39;) }}&lt;/p&gt;
      &lt;p&gt;🔥 最高溫：{{ getWeatherElement(city, &#39;MaxT&#39;) }}°C&lt;/p&gt;
      &lt;p&gt;❄️ 最低溫：{{ getWeatherElement(city, &#39;MinT&#39;) }}°C&lt;/p&gt;
      &lt;p&gt;🌧️ 降雨機率：{{ getWeatherElement(city, &#39;PoP&#39;) }}%&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, computed, onMounted } from &#39;vue&#39;

const apiKey = &#39;你的 CWA API Key&#39; // 請換成你的
const url = `https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=${apiKey}`

const weatherData = ref([])
const allCityNames = ref([])
const selectedCities = ref([])
const limitReached = ref(false)

onMounted(async () =&gt; {
  try {
    const response = await fetch(url)
    const data = await response.json()
    const locations = data.records.location

    weatherData.value = locations
    allCityNames.value = locations.map(loc =&gt; loc.locationName)

    // 預設三個城市
    selectedCities.value = [&#39;臺北市&#39;, &#39;臺中市&#39;, &#39;高雄市&#39;]
  } catch (error) {
    console.error(&#39;❌ 發生錯誤:&#39;, error)
  }
})

// ✅ 限制最多三個城市
function checkLimit() {
  if (selectedCities.value.length &gt; 3) {
    selectedCities.value.pop() // 移除最後選的
    limitReached.value = true
    setTimeout(() =&gt; {
      limitReached.value = false
    }, 2000)
  }
}

const filteredWeatherData = computed(() =&gt;
  weatherData.value.filter(city =&gt; selectedCities.value.includes(city.locationName))
)

function getWeatherElement(city, elementName) {
  const element = city.weatherElement.find(el =&gt; el.elementName === elementName)
  return element?.time[0]?.parameter?.parameterName || &#39;N/A&#39;
}
&lt;/script&gt;

&lt;style scoped&gt;
select {
  width: 100%;
  padding: 0.5rem;
  margin-bottom: 0.5rem;
  font-size: 1rem;
}

.weather-container {
  display: flex;
  flex-wrap: wrap;
  gap: 1.5rem;
}

.city-card {
  flex: 1 1 300px;
  max-width: 300px;
  background: #f0f8ff;
  padding: 1rem;
  border-radius: 0.75rem;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  border-left: 6px solid #3498db;
}
&lt;/style&gt;
</code></pre>
<hr>
<h3 id="🧠-重點說明："><a href="#🧠-重點說明：" class="headerlink" title="🧠 重點說明："></a>🧠 重點說明：</h3><table>
<thead>
<tr>
<th>部分</th>
<th>說明</th>
</tr>
</thead>
<tbody><tr>
<td><code>@change=&quot;checkLimit&quot;</code></td>
<td>每次下拉選單變動時，觸發檢查</td>
</tr>
<tr>
<td><code>selectedCities.value.pop()</code></td>
<td>超過 3 個，就把最後選的移除</td>
</tr>
<tr>
<td><code>limitReached</code></td>
<td>用來控制是否顯示警告訊息</td>
</tr>
</tbody></table>
<hr>
<p>你可以自己試著把 <code>3</code> 改成 <code>2</code> 或 <code>5</code> 看會發生什麼～</p>
